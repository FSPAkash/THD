{"ast":null,"code":"import _objectSpread from\"C:/Users/AkashPatil/THD-Dashboard/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useRef,useCallback,useEffect}from'react';import{LineChart,Line,AreaChart,Area,BarChart,Bar,XAxis,YAxis,CartesianGrid,Tooltip,ResponsiveContainer,ReferenceLine,Legend}from'recharts';import{useAuth}from'../context/AuthContext';import'./KPIChart.css';// Preset event tags\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PRESET_TAGS=[{id:'thanksgiving',name:'Thanksgiving',color:'#F96302'},{id:'blackfriday',name:'Black Friday',color:'#1d1d1f'},{id:'laborday',name:'Labor Day',color:'#007AFF'},{id:'july4th',name:'4th of July',color:'#FF3B30'},{id:'tier1',name:'Tier 1 Event',color:'#5856D6'}];// Chart margins matching Recharts config\nconst CHART_MARGINS={top:20,right:20,left:10,bottom:20};const Y_AXIS_WIDTH=60;function KPIChart(_ref){let{data,kpi,chartType,format,launchDate,comparisonData,chartTags,onTagsChange}=_ref;const{isBetaMode}=useAuth();const isBeta=isBetaMode();const chartContainerRef=useRef(null);const[showTagPanel,setShowTagPanel]=useState(false);const[customTagName,setCustomTagName]=useState('');const[customTagOwner,setCustomTagOwner]=useState('');const[draggedTag,setDraggedTag]=useState(null);const[showCustomForm,setShowCustomForm]=useState(false);const[dragPreview,setDragPreview]=useState(null);const[chartDimensions,setChartDimensions]=useState({width:0,height:0});// Use comparison data if available, otherwise fall back to regular data\nconst chartData=comparisonData&&comparisonData.length>0?comparisonData:data;const hasComparison=comparisonData&&comparisonData.length>0;// Update chart dimensions on resize\nuseEffect(()=>{const updateDimensions=()=>{if(chartContainerRef.current){const rect=chartContainerRef.current.getBoundingClientRect();setChartDimensions({width:rect.width,height:rect.height});}};updateDimensions();window.addEventListener('resize',updateDimensions);return()=>window.removeEventListener('resize',updateDimensions);},[]);const formatValue=val=>{if(val===null||val===undefined||isNaN(val))return'-';if(format==='currency'){if(Math.abs(val)>=1000000){return\"$\".concat((val/1000000).toFixed(1),\"M\");}if(Math.abs(val)>=1000){return\"$\".concat((val/1000).toFixed(0),\"K\");}return\"$\".concat(val.toFixed(2));}if(format==='percentage'){return\"\".concat((val*100).toFixed(2),\"%\");}if(Math.abs(val)>=1000000){return\"\".concat((val/1000000).toFixed(1),\"M\");}if(Math.abs(val)>=1000){return\"\".concat((val/1000).toFixed(0),\"K\");}return val.toLocaleString();};const formatAxisDate=dateStr=>{const date=new Date(dateStr);return date.toLocaleDateString('en-US',{month:'short',day:'numeric'});};const formatFullDate=dateStr=>{const date=new Date(dateStr);return date.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric',year:'numeric'});};// Calculate date index from x position\nconst getDateIndexFromX=useCallback(clientX=>{if(!chartContainerRef.current||!chartData||chartData.length===0)return-1;const rect=chartContainerRef.current.getBoundingClientRect();const chartAreaLeft=Y_AXIS_WIDTH+CHART_MARGINS.left;const chartAreaWidth=rect.width-chartAreaLeft-CHART_MARGINS.right;const relativeX=clientX-rect.left-chartAreaLeft;const percentage=relativeX/chartAreaWidth;const dataIndex=Math.round(percentage*(chartData.length-1));return Math.max(0,Math.min(dataIndex,chartData.length-1));},[chartData]);// Get x position for a data index\nconst getXPositionForIndex=useCallback(index=>{if(!chartDimensions.width||!chartData||chartData.length===0)return 0;const chartAreaLeft=Y_AXIS_WIDTH+CHART_MARGINS.left;const chartAreaWidth=chartDimensions.width-chartAreaLeft-CHART_MARGINS.right;const percentage=index/(chartData.length-1);return chartAreaLeft+percentage*chartAreaWidth;},[chartDimensions.width,chartData]);const CustomTooltip=_ref2=>{let{active,payload,label}=_ref2;if(active&&payload&&payload.length){const dateStr=new Date(label).toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric',year:'numeric'});// Check if there's a tag for this date\nconst dateTag=chartTags===null||chartTags===void 0?void 0:chartTags.find(t=>t.date===label);return/*#__PURE__*/_jsxs(\"div\",{className:\"chart-tooltip\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"tooltip-date\",children:dateStr}),dateTag&&/*#__PURE__*/_jsxs(\"p\",{className:\"tooltip-tag\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"tooltip-tag-marker\",style:{background:dateTag.color}}),dateTag.name]}),payload.map((entry,index)=>/*#__PURE__*/_jsxs(\"p\",{className:\"tooltip-value\",style:{color:entry.color},children:[/*#__PURE__*/_jsxs(\"span\",{className:\"tooltip-label\",children:[entry.name,\": \"]}),formatValue(entry.value)]},index))]});}return null;};const handleDragStart=(e,tag)=>{setDraggedTag(tag);e.dataTransfer.effectAllowed='copy';// Set a transparent drag image\nconst img=new Image();img.src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';e.dataTransfer.setDragImage(img,0,0);};const handleDragOver=e=>{var _chartData$dateIndex;e.preventDefault();e.dataTransfer.dropEffect='copy';if(!draggedTag||!chartData||chartData.length===0)return;const dateIndex=getDateIndexFromX(e.clientX);const targetDate=(_chartData$dateIndex=chartData[dateIndex])===null||_chartData$dateIndex===void 0?void 0:_chartData$dateIndex.date;const xPosition=getXPositionForIndex(dateIndex);if(targetDate&&dateIndex>=0){setDragPreview({date:targetDate,formattedDate:formatFullDate(targetDate),x:xPosition,index:dateIndex,tag:draggedTag});}};const handleDragLeave=e=>{var _chartContainerRef$cu;// Only clear preview if we're actually leaving the chart area\nconst rect=(_chartContainerRef$cu=chartContainerRef.current)===null||_chartContainerRef$cu===void 0?void 0:_chartContainerRef$cu.getBoundingClientRect();if(rect){const{clientX,clientY}=e;if(clientX<rect.left||clientX>rect.right||clientY<rect.top||clientY>rect.bottom){setDragPreview(null);}}};const handleDrop=e=>{var _chartData$dateIndex2;e.preventDefault();if(!draggedTag||!chartData||chartData.length===0)return;const dateIndex=getDateIndexFromX(e.clientX);const targetDate=(_chartData$dateIndex2=chartData[dateIndex])===null||_chartData$dateIndex2===void 0?void 0:_chartData$dateIndex2.date;if(targetDate){const newTag=_objectSpread(_objectSpread({},draggedTag),{},{id:\"\".concat(draggedTag.id,\"-\").concat(Date.now()),date:targetDate,dateIndex:dateIndex});if(onTagsChange){onTagsChange([...(chartTags||[]),newTag]);}}setDraggedTag(null);setDragPreview(null);};const handleDragEnd=()=>{setDragPreview(null);};const handleAddCustomTag=()=>{if(!customTagName.trim()||!customTagOwner.trim())return;const newTag={id:\"custom-\".concat(Date.now()),name:customTagName.trim(),owner:customTagOwner.trim(),color:'#6e6e73',isCustom:true};setDraggedTag(newTag);setCustomTagName('');setCustomTagOwner('');setShowCustomForm(false);};const handleRemoveTag=tagId=>{if(onTagsChange){onTagsChange((chartTags||[]).filter(t=>t.id!==tagId));}};const commonProps={data:chartData,margin:CHART_MARGINS};const axisStyle={fontSize:11,fill:'#86868b',fontWeight:500};// Get the correct data keys based on comparison mode\nconst tyDataKey=hasComparison?\"\".concat(kpi,\"_ty\"):kpi;const lyDataKey=hasComparison?\"\".concat(kpi,\"_ly\"):null;// Render placed tags as overlay elements\nconst renderPlacedTags=()=>{if(!chartTags||chartTags.length===0||!chartDimensions.width)return null;return chartTags.map(tag=>{const dateIndex=chartData===null||chartData===void 0?void 0:chartData.findIndex(d=>d.date===tag.date);if(dateIndex===-1)return null;const xPos=getXPositionForIndex(dateIndex);const chartHeight=320;// Fixed chart height\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"placed-tag-container\",style:{left:xPos},children:[/*#__PURE__*/_jsx(\"div\",{className:\"tag-line\",style:{borderColor:tag.color,height:chartHeight-CHART_MARGINS.top-CHART_MARGINS.bottom-30}}),/*#__PURE__*/_jsxs(\"div\",{className:\"placed-tag\",style:{'--tag-color':tag.color,borderColor:tag.color},children:[/*#__PURE__*/_jsx(\"span\",{className:\"placed-tag-marker\",style:{background:tag.color}}),/*#__PURE__*/_jsx(\"span\",{className:\"placed-tag-name\",children:tag.name}),tag.owner&&/*#__PURE__*/_jsxs(\"span\",{className:\"placed-tag-owner\",children:[\"by \",tag.owner]}),/*#__PURE__*/_jsx(\"button\",{className:\"placed-tag-remove\",onClick:()=>handleRemoveTag(tag.id),title:\"Remove tag\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"10\",height:\"10\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"6\",x2:\"6\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"6\",x2:\"18\",y2:\"18\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tag-date-label\",style:{color:tag.color},children:formatAxisDate(tag.date)})]},tag.id);});};// Render drag preview\nconst renderDragPreview=()=>{if(!dragPreview)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"drag-preview-container\",style:{left:dragPreview.x},children:[/*#__PURE__*/_jsx(\"div\",{className:\"preview-line\",style:{borderColor:dragPreview.tag.color}}),/*#__PURE__*/_jsxs(\"div\",{className:\"preview-tag\",style:{'--tag-color':dragPreview.tag.color,borderColor:dragPreview.tag.color},children:[/*#__PURE__*/_jsx(\"span\",{className:\"preview-tag-marker\",style:{background:dragPreview.tag.color}}),/*#__PURE__*/_jsx(\"span\",{className:\"preview-tag-name\",children:dragPreview.tag.name})]}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-date\",style:{borderColor:dragPreview.tag.color},children:dragPreview.formattedDate})]});};const renderChart=()=>{switch(chartType){case'area':return/*#__PURE__*/_jsxs(AreaChart,_objectSpread(_objectSpread({},commonProps),{},{children:[/*#__PURE__*/_jsxs(\"defs\",{children:[/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"areaGradientTY\",x1:\"0\",y1:\"0\",x2:\"0\",y2:\"1\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"0%\",stopColor:\"#F96302\",stopOpacity:0.25}),/*#__PURE__*/_jsx(\"stop\",{offset:\"100%\",stopColor:\"#F96302\",stopOpacity:0})]}),/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"areaGradientLY\",x1:\"0\",y1:\"0\",x2:\"0\",y2:\"1\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"0%\",stopColor:\"#86868b\",stopOpacity:0.15}),/*#__PURE__*/_jsx(\"stop\",{offset:\"100%\",stopColor:\"#86868b\",stopOpacity:0})]})]}),/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"rgba(0,0,0,0.04)\",vertical:false}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\",tick:axisStyle,tickLine:false,axisLine:{stroke:'rgba(0,0,0,0.08)'},tickFormatter:formatAxisDate,interval:\"preserveStartEnd\"}),/*#__PURE__*/_jsx(YAxis,{tick:axisStyle,tickLine:false,axisLine:false,tickFormatter:formatValue,width:Y_AXIS_WIDTH}),/*#__PURE__*/_jsx(Tooltip,{content:/*#__PURE__*/_jsx(CustomTooltip,{})}),hasComparison&&/*#__PURE__*/_jsx(Legend,{}),launchDate&&/*#__PURE__*/_jsx(ReferenceLine,{x:launchDate,stroke:\"#F96302\",strokeDasharray:\"4 4\",strokeWidth:2,label:{value:'Launch',position:'top',fill:'#F96302',fontSize:11,fontWeight:600}}),hasComparison&&lyDataKey&&/*#__PURE__*/_jsx(Area,{type:\"monotone\",dataKey:lyDataKey,name:\"Last Year\",stroke:\"#86868b\",strokeWidth:1.5,strokeDasharray:\"4 4\",fill:\"url(#areaGradientLY)\",dot:false,activeDot:{r:4,fill:'#86868b',stroke:'#fff',strokeWidth:2}}),/*#__PURE__*/_jsx(Area,{type:\"monotone\",dataKey:tyDataKey,name:hasComparison?\"This Year\":kpi,stroke:\"#F96302\",strokeWidth:2,fill:\"url(#areaGradientTY)\",dot:false,activeDot:{r:5,fill:'#F96302',stroke:'#fff',strokeWidth:2}})]}));case'bar':return/*#__PURE__*/_jsxs(BarChart,_objectSpread(_objectSpread({},commonProps),{},{children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"rgba(0,0,0,0.04)\",vertical:false}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\",tick:axisStyle,tickLine:false,axisLine:{stroke:'rgba(0,0,0,0.08)'},tickFormatter:formatAxisDate,interval:\"preserveStartEnd\"}),/*#__PURE__*/_jsx(YAxis,{tick:axisStyle,tickLine:false,axisLine:false,tickFormatter:formatValue,width:Y_AXIS_WIDTH}),/*#__PURE__*/_jsx(Tooltip,{content:/*#__PURE__*/_jsx(CustomTooltip,{})}),hasComparison&&/*#__PURE__*/_jsx(Legend,{}),launchDate&&/*#__PURE__*/_jsx(ReferenceLine,{x:launchDate,stroke:\"#F96302\",strokeDasharray:\"4 4\",strokeWidth:2}),hasComparison&&lyDataKey&&/*#__PURE__*/_jsx(Bar,{dataKey:lyDataKey,name:\"Last Year\",fill:\"#d1d1d6\",radius:[4,4,0,0],maxBarSize:20}),/*#__PURE__*/_jsx(Bar,{dataKey:tyDataKey,name:hasComparison?\"This Year\":kpi,fill:\"#F96302\",radius:[4,4,0,0],maxBarSize:hasComparison?20:40})]}));default:return/*#__PURE__*/_jsxs(LineChart,_objectSpread(_objectSpread({},commonProps),{},{children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"rgba(0,0,0,0.04)\",vertical:false}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\",tick:axisStyle,tickLine:false,axisLine:{stroke:'rgba(0,0,0,0.08)'},tickFormatter:formatAxisDate,interval:\"preserveStartEnd\"}),/*#__PURE__*/_jsx(YAxis,{tick:axisStyle,tickLine:false,axisLine:false,tickFormatter:formatValue,width:Y_AXIS_WIDTH}),/*#__PURE__*/_jsx(Tooltip,{content:/*#__PURE__*/_jsx(CustomTooltip,{})}),hasComparison&&/*#__PURE__*/_jsx(Legend,{}),launchDate&&/*#__PURE__*/_jsx(ReferenceLine,{x:launchDate,stroke:\"#F96302\",strokeDasharray:\"4 4\",strokeWidth:2,label:{value:'Launch',position:'top',fill:'#F96302',fontSize:11,fontWeight:600}}),hasComparison&&lyDataKey&&/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:lyDataKey,name:\"Last Year\",stroke:\"#86868b\",strokeWidth:1.5,strokeDasharray:\"4 4\",dot:false,activeDot:{r:4,fill:'#86868b',stroke:'#fff',strokeWidth:2}}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:tyDataKey,name:hasComparison?\"This Year\":kpi,stroke:\"#F96302\",strokeWidth:2,dot:false,activeDot:{r:5,fill:'#F96302',stroke:'#fff',strokeWidth:2}})]}));}};if(!chartData||chartData.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"chart-empty\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No data available for the selected period\"})});}if(isBeta){return/*#__PURE__*/_jsxs(\"div\",{className:\"kpi-chart beta-restricted\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chart-blur-wrapper\",children:/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:320,children:renderChart()})}),/*#__PURE__*/_jsx(\"div\",{className:\"beta-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"beta-overlay-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Place holder\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Chart visualization\"})]})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"kpi-chart-wrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"kpi-chart \".concat(draggedTag?'drop-active':''),ref:chartContainerRef,onDragOver:handleDragOver,onDragLeave:handleDragLeave,onDrop:handleDrop,children:[/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:320,children:renderChart()}),/*#__PURE__*/_jsx(\"div\",{className:\"tags-overlay\",children:renderPlacedTags()}),dragPreview&&/*#__PURE__*/_jsx(\"div\",{className:\"drag-preview-overlay\",children:renderDragPreview()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-tag-controls\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"tag-panel-toggle \".concat(showTagPanel?'active':''),onClick:()=>setShowTagPanel(!showTagPanel),children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"7\",y1:\"7\",x2:\"7.01\",y2:\"7\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"Add Info Tag\"})]}),chartTags&&chartTags.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"active-tags\",children:chartTags.map(tag=>/*#__PURE__*/_jsxs(\"span\",{className:\"active-tag\",style:{borderColor:tag.color,color:tag.color},children:[/*#__PURE__*/_jsx(\"span\",{className:\"tag-marker\",style:{background:tag.color}}),tag.name,/*#__PURE__*/_jsx(\"span\",{className:\"tag-date\",children:formatAxisDate(tag.date)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRemoveTag(tag.id),className:\"tag-remove\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"12\",height:\"12\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"6\",x2:\"6\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"6\",x2:\"18\",y2:\"18\"})]})})]},tag.id))})]}),showTagPanel&&/*#__PURE__*/_jsxs(\"div\",{className:\"tag-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tag-panel-header\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Drag tags onto the chart\"}),/*#__PURE__*/_jsx(\"button\",{className:\"tag-panel-close\",onClick:()=>setShowTagPanel(false),children:/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"6\",x2:\"6\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"6\",x2:\"18\",y2:\"18\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"preset-tags\",children:PRESET_TAGS.map(tag=>/*#__PURE__*/_jsxs(\"div\",{className:\"draggable-tag\",draggable:true,onDragStart:e=>handleDragStart(e,tag),onDragEnd:handleDragEnd,style:{borderColor:tag.color},children:[/*#__PURE__*/_jsx(\"span\",{className:\"tag-marker\",style:{background:tag.color}}),tag.name]},tag.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"custom-tag-section\",children:!showCustomForm?/*#__PURE__*/_jsxs(\"button\",{className:\"add-custom-tag-btn\",onClick:()=>setShowCustomForm(true),children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"14\",height:\"14\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"5\",x2:\"12\",y2:\"19\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"5\",y1:\"12\",x2:\"19\",y2:\"12\"})]}),\"Create Custom Tag\"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"custom-tag-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Tag name\",value:customTagName,onChange:e=>setCustomTagName(e.target.value),className:\"custom-tag-input\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Your name (owner)\",value:customTagOwner,onChange:e=>setCustomTagOwner(e.target.value),className:\"custom-tag-input\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-tag-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"custom-tag-cancel\",onClick:()=>{setShowCustomForm(false);setCustomTagName('');setCustomTagOwner('');},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"custom-tag-create\",onClick:handleAddCustomTag,disabled:!customTagName.trim()||!customTagOwner.trim(),children:\"Create & Drag\"})]})]})}),draggedTag&&draggedTag.isCustom&&/*#__PURE__*/_jsxs(\"div\",{className:\"drag-instruction\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Now drag your custom tag \\\"\",draggedTag.name,\"\\\" onto the chart\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"draggable-tag custom\",draggable:true,onDragStart:e=>handleDragStart(e,draggedTag),onDragEnd:handleDragEnd,children:[/*#__PURE__*/_jsx(\"span\",{className:\"tag-marker\",style:{background:draggedTag.color}}),draggedTag.name,/*#__PURE__*/_jsxs(\"span\",{className:\"tag-owner\",children:[\"by \",draggedTag.owner]})]})]})]})]});}export default KPIChart;","map":{"version":3,"names":["useState","useRef","useCallback","useEffect","LineChart","Line","AreaChart","Area","BarChart","Bar","XAxis","YAxis","CartesianGrid","Tooltip","ResponsiveContainer","ReferenceLine","Legend","useAuth","jsx","_jsx","jsxs","_jsxs","PRESET_TAGS","id","name","color","CHART_MARGINS","top","right","left","bottom","Y_AXIS_WIDTH","KPIChart","_ref","data","kpi","chartType","format","launchDate","comparisonData","chartTags","onTagsChange","isBetaMode","isBeta","chartContainerRef","showTagPanel","setShowTagPanel","customTagName","setCustomTagName","customTagOwner","setCustomTagOwner","draggedTag","setDraggedTag","showCustomForm","setShowCustomForm","dragPreview","setDragPreview","chartDimensions","setChartDimensions","width","height","chartData","length","hasComparison","updateDimensions","current","rect","getBoundingClientRect","window","addEventListener","removeEventListener","formatValue","val","undefined","isNaN","Math","abs","concat","toFixed","toLocaleString","formatAxisDate","dateStr","date","Date","toLocaleDateString","month","day","formatFullDate","weekday","year","getDateIndexFromX","clientX","chartAreaLeft","chartAreaWidth","relativeX","percentage","dataIndex","round","max","min","getXPositionForIndex","index","CustomTooltip","_ref2","active","payload","label","dateTag","find","t","className","children","style","background","map","entry","value","handleDragStart","e","tag","dataTransfer","effectAllowed","img","Image","src","setDragImage","handleDragOver","_chartData$dateIndex","preventDefault","dropEffect","dateIndex","targetDate","xPosition","formattedDate","x","handleDragLeave","_chartContainerRef$cu","clientY","handleDrop","_chartData$dateIndex2","newTag","_objectSpread","now","handleDragEnd","handleAddCustomTag","trim","owner","isCustom","handleRemoveTag","tagId","filter","commonProps","margin","axisStyle","fontSize","fill","fontWeight","tyDataKey","lyDataKey","renderPlacedTags","findIndex","d","xPos","chartHeight","borderColor","onClick","title","viewBox","stroke","strokeWidth","x1","y1","x2","y2","renderDragPreview","renderChart","offset","stopColor","stopOpacity","strokeDasharray","vertical","dataKey","tick","tickLine","axisLine","tickFormatter","interval","content","position","type","dot","activeDot","r","radius","maxBarSize","ref","onDragOver","onDragLeave","onDrop","strokeLinecap","strokeLinejoin","draggable","onDragStart","onDragEnd","placeholder","onChange","target","disabled"],"sources":["C:/Users/AkashPatil/THD-Dashboard/frontend/src/components/KPIChart.js"],"sourcesContent":["import { useState, useRef, useCallback, useEffect } from 'react';\r\nimport {\r\n  LineChart, Line, AreaChart, Area, BarChart, Bar,\r\n  XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer,\r\n  ReferenceLine, Legend\r\n} from 'recharts';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport './KPIChart.css';\r\n\r\n// Preset event tags\r\nconst PRESET_TAGS = [\r\n  { id: 'thanksgiving', name: 'Thanksgiving', color: '#F96302' },\r\n  { id: 'blackfriday', name: 'Black Friday', color: '#1d1d1f' },\r\n  { id: 'laborday', name: 'Labor Day', color: '#007AFF' },\r\n  { id: 'july4th', name: '4th of July', color: '#FF3B30' },\r\n  { id: 'tier1', name: 'Tier 1 Event', color: '#5856D6' }\r\n];\r\n\r\n// Chart margins matching Recharts config\r\nconst CHART_MARGINS = { top: 20, right: 20, left: 10, bottom: 20 };\r\nconst Y_AXIS_WIDTH = 60;\r\n\r\nfunction KPIChart({ data, kpi, chartType, format, launchDate, comparisonData, chartTags, onTagsChange }) {\r\n  const { isBetaMode } = useAuth();\r\n  const isBeta = isBetaMode();\r\n  const chartContainerRef = useRef(null);\r\n  const [showTagPanel, setShowTagPanel] = useState(false);\r\n  const [customTagName, setCustomTagName] = useState('');\r\n  const [customTagOwner, setCustomTagOwner] = useState('');\r\n  const [draggedTag, setDraggedTag] = useState(null);\r\n  const [showCustomForm, setShowCustomForm] = useState(false);\r\n  const [dragPreview, setDragPreview] = useState(null);\r\n  const [chartDimensions, setChartDimensions] = useState({ width: 0, height: 0 });\r\n\r\n  // Use comparison data if available, otherwise fall back to regular data\r\n  const chartData = comparisonData && comparisonData.length > 0 ? comparisonData : data;\r\n  const hasComparison = comparisonData && comparisonData.length > 0;\r\n\r\n  // Update chart dimensions on resize\r\n  useEffect(() => {\r\n    const updateDimensions = () => {\r\n      if (chartContainerRef.current) {\r\n        const rect = chartContainerRef.current.getBoundingClientRect();\r\n        setChartDimensions({ width: rect.width, height: rect.height });\r\n      }\r\n    };\r\n\r\n    updateDimensions();\r\n    window.addEventListener('resize', updateDimensions);\r\n    return () => window.removeEventListener('resize', updateDimensions);\r\n  }, []);\r\n\r\n  const formatValue = (val) => {\r\n    if (val === null || val === undefined || isNaN(val)) return '-';\r\n\r\n    if (format === 'currency') {\r\n      if (Math.abs(val) >= 1000000) {\r\n        return `$${(val / 1000000).toFixed(1)}M`;\r\n      }\r\n      if (Math.abs(val) >= 1000) {\r\n        return `$${(val / 1000).toFixed(0)}K`;\r\n      }\r\n      return `$${val.toFixed(2)}`;\r\n    }\r\n    if (format === 'percentage') {\r\n      return `${(val * 100).toFixed(2)}%`;\r\n    }\r\n    if (Math.abs(val) >= 1000000) {\r\n      return `${(val / 1000000).toFixed(1)}M`;\r\n    }\r\n    if (Math.abs(val) >= 1000) {\r\n      return `${(val / 1000).toFixed(0)}K`;\r\n    }\r\n    return val.toLocaleString();\r\n  };\r\n\r\n  const formatAxisDate = (dateStr) => {\r\n    const date = new Date(dateStr);\r\n    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });\r\n  };\r\n\r\n  const formatFullDate = (dateStr) => {\r\n    const date = new Date(dateStr);\r\n    return date.toLocaleDateString('en-US', {\r\n      weekday: 'short',\r\n      month: 'short',\r\n      day: 'numeric',\r\n      year: 'numeric'\r\n    });\r\n  };\r\n\r\n  // Calculate date index from x position\r\n  const getDateIndexFromX = useCallback((clientX) => {\r\n    if (!chartContainerRef.current || !chartData || chartData.length === 0) return -1;\r\n\r\n    const rect = chartContainerRef.current.getBoundingClientRect();\r\n    const chartAreaLeft = Y_AXIS_WIDTH + CHART_MARGINS.left;\r\n    const chartAreaWidth = rect.width - chartAreaLeft - CHART_MARGINS.right;\r\n\r\n    const relativeX = clientX - rect.left - chartAreaLeft;\r\n    const percentage = relativeX / chartAreaWidth;\r\n\r\n    const dataIndex = Math.round(percentage * (chartData.length - 1));\r\n    return Math.max(0, Math.min(dataIndex, chartData.length - 1));\r\n  }, [chartData]);\r\n\r\n  // Get x position for a data index\r\n  const getXPositionForIndex = useCallback((index) => {\r\n    if (!chartDimensions.width || !chartData || chartData.length === 0) return 0;\r\n\r\n    const chartAreaLeft = Y_AXIS_WIDTH + CHART_MARGINS.left;\r\n    const chartAreaWidth = chartDimensions.width - chartAreaLeft - CHART_MARGINS.right;\r\n\r\n    const percentage = index / (chartData.length - 1);\r\n    return chartAreaLeft + (percentage * chartAreaWidth);\r\n  }, [chartDimensions.width, chartData]);\r\n\r\n  const CustomTooltip = ({ active, payload, label }) => {\r\n    if (active && payload && payload.length) {\r\n      const dateStr = new Date(label).toLocaleDateString('en-US', {\r\n        weekday: 'short',\r\n        month: 'short',\r\n        day: 'numeric',\r\n        year: 'numeric'\r\n      });\r\n\r\n      // Check if there's a tag for this date\r\n      const dateTag = chartTags?.find(t => t.date === label);\r\n\r\n      return (\r\n        <div className=\"chart-tooltip\">\r\n          <p className=\"tooltip-date\">{dateStr}</p>\r\n          {dateTag && (\r\n            <p className=\"tooltip-tag\">\r\n              <span className=\"tooltip-tag-marker\" style={{ background: dateTag.color }}></span>\r\n              {dateTag.name}\r\n            </p>\r\n          )}\r\n          {payload.map((entry, index) => (\r\n            <p key={index} className=\"tooltip-value\" style={{ color: entry.color }}>\r\n              <span className=\"tooltip-label\">{entry.name}: </span>\r\n              {formatValue(entry.value)}\r\n            </p>\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const handleDragStart = (e, tag) => {\r\n    setDraggedTag(tag);\r\n    e.dataTransfer.effectAllowed = 'copy';\r\n    // Set a transparent drag image\r\n    const img = new Image();\r\n    img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\r\n    e.dataTransfer.setDragImage(img, 0, 0);\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = 'copy';\r\n\r\n    if (!draggedTag || !chartData || chartData.length === 0) return;\r\n\r\n    const dateIndex = getDateIndexFromX(e.clientX);\r\n    const targetDate = chartData[dateIndex]?.date;\r\n    const xPosition = getXPositionForIndex(dateIndex);\r\n\r\n    if (targetDate && dateIndex >= 0) {\r\n      setDragPreview({\r\n        date: targetDate,\r\n        formattedDate: formatFullDate(targetDate),\r\n        x: xPosition,\r\n        index: dateIndex,\r\n        tag: draggedTag\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    // Only clear preview if we're actually leaving the chart area\r\n    const rect = chartContainerRef.current?.getBoundingClientRect();\r\n    if (rect) {\r\n      const { clientX, clientY } = e;\r\n      if (clientX < rect.left || clientX > rect.right ||\r\n          clientY < rect.top || clientY > rect.bottom) {\r\n        setDragPreview(null);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    if (!draggedTag || !chartData || chartData.length === 0) return;\r\n\r\n    const dateIndex = getDateIndexFromX(e.clientX);\r\n    const targetDate = chartData[dateIndex]?.date;\r\n\r\n    if (targetDate) {\r\n      const newTag = {\r\n        ...draggedTag,\r\n        id: `${draggedTag.id}-${Date.now()}`,\r\n        date: targetDate,\r\n        dateIndex: dateIndex\r\n      };\r\n\r\n      if (onTagsChange) {\r\n        onTagsChange([...(chartTags || []), newTag]);\r\n      }\r\n    }\r\n\r\n    setDraggedTag(null);\r\n    setDragPreview(null);\r\n  };\r\n\r\n  const handleDragEnd = () => {\r\n    setDragPreview(null);\r\n  };\r\n\r\n  const handleAddCustomTag = () => {\r\n    if (!customTagName.trim() || !customTagOwner.trim()) return;\r\n\r\n    const newTag = {\r\n      id: `custom-${Date.now()}`,\r\n      name: customTagName.trim(),\r\n      owner: customTagOwner.trim(),\r\n      color: '#6e6e73',\r\n      isCustom: true\r\n    };\r\n\r\n    setDraggedTag(newTag);\r\n    setCustomTagName('');\r\n    setCustomTagOwner('');\r\n    setShowCustomForm(false);\r\n  };\r\n\r\n  const handleRemoveTag = (tagId) => {\r\n    if (onTagsChange) {\r\n      onTagsChange((chartTags || []).filter(t => t.id !== tagId));\r\n    }\r\n  };\r\n\r\n  const commonProps = {\r\n    data: chartData,\r\n    margin: CHART_MARGINS\r\n  };\r\n\r\n  const axisStyle = {\r\n    fontSize: 11,\r\n    fill: '#86868b',\r\n    fontWeight: 500\r\n  };\r\n\r\n  // Get the correct data keys based on comparison mode\r\n  const tyDataKey = hasComparison ? `${kpi}_ty` : kpi;\r\n  const lyDataKey = hasComparison ? `${kpi}_ly` : null;\r\n\r\n  // Render placed tags as overlay elements\r\n  const renderPlacedTags = () => {\r\n    if (!chartTags || chartTags.length === 0 || !chartDimensions.width) return null;\r\n\r\n    return chartTags.map((tag) => {\r\n      const dateIndex = chartData?.findIndex(d => d.date === tag.date);\r\n      if (dateIndex === -1) return null;\r\n\r\n      const xPos = getXPositionForIndex(dateIndex);\r\n      const chartHeight = 320; // Fixed chart height\r\n\r\n      return (\r\n        <div\r\n          key={tag.id}\r\n          className=\"placed-tag-container\"\r\n          style={{ left: xPos }}\r\n        >\r\n          {/* Dotted line from tag to axis */}\r\n          <div\r\n            className=\"tag-line\"\r\n            style={{\r\n              borderColor: tag.color,\r\n              height: chartHeight - CHART_MARGINS.top - CHART_MARGINS.bottom - 30\r\n            }}\r\n          />\r\n          {/* Glass tag badge */}\r\n          <div\r\n            className=\"placed-tag\"\r\n            style={{\r\n              '--tag-color': tag.color,\r\n              borderColor: tag.color\r\n            }}\r\n          >\r\n            <span className=\"placed-tag-marker\" style={{ background: tag.color }}></span>\r\n            <span className=\"placed-tag-name\">{tag.name}</span>\r\n            {tag.owner && <span className=\"placed-tag-owner\">by {tag.owner}</span>}\r\n            <button\r\n              className=\"placed-tag-remove\"\r\n              onClick={() => handleRemoveTag(tag.id)}\r\n              title=\"Remove tag\"\r\n            >\r\n              <svg width=\"10\" height=\"10\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\r\n                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n          {/* Date label at bottom */}\r\n          <div className=\"tag-date-label\" style={{ color: tag.color }}>\r\n            {formatAxisDate(tag.date)}\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  // Render drag preview\r\n  const renderDragPreview = () => {\r\n    if (!dragPreview) return null;\r\n\r\n    return (\r\n      <div\r\n        className=\"drag-preview-container\"\r\n        style={{ left: dragPreview.x }}\r\n      >\r\n        {/* Preview dotted line */}\r\n        <div\r\n          className=\"preview-line\"\r\n          style={{ borderColor: dragPreview.tag.color }}\r\n        />\r\n        {/* Preview tag */}\r\n        <div\r\n          className=\"preview-tag\"\r\n          style={{\r\n            '--tag-color': dragPreview.tag.color,\r\n            borderColor: dragPreview.tag.color\r\n          }}\r\n        >\r\n          <span className=\"preview-tag-marker\" style={{ background: dragPreview.tag.color }}></span>\r\n          <span className=\"preview-tag-name\">{dragPreview.tag.name}</span>\r\n        </div>\r\n        {/* Date display */}\r\n        <div className=\"preview-date\" style={{ borderColor: dragPreview.tag.color }}>\r\n          {dragPreview.formattedDate}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderChart = () => {\r\n    switch (chartType) {\r\n      case 'area':\r\n        return (\r\n          <AreaChart {...commonProps}>\r\n            <defs>\r\n              <linearGradient id=\"areaGradientTY\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                <stop offset=\"0%\" stopColor=\"#F96302\" stopOpacity={0.25}/>\r\n                <stop offset=\"100%\" stopColor=\"#F96302\" stopOpacity={0}/>\r\n              </linearGradient>\r\n              <linearGradient id=\"areaGradientLY\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                <stop offset=\"0%\" stopColor=\"#86868b\" stopOpacity={0.15}/>\r\n                <stop offset=\"100%\" stopColor=\"#86868b\" stopOpacity={0}/>\r\n              </linearGradient>\r\n            </defs>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,0,0,0.04)\" vertical={false} />\r\n            <XAxis\r\n              dataKey=\"date\"\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={{ stroke: 'rgba(0,0,0,0.08)' }}\r\n              tickFormatter={formatAxisDate}\r\n              interval=\"preserveStartEnd\"\r\n            />\r\n            <YAxis\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={false}\r\n              tickFormatter={formatValue}\r\n              width={Y_AXIS_WIDTH}\r\n            />\r\n            <Tooltip content={<CustomTooltip />} />\r\n            {hasComparison && <Legend />}\r\n            {launchDate && (\r\n              <ReferenceLine\r\n                x={launchDate}\r\n                stroke=\"#F96302\"\r\n                strokeDasharray=\"4 4\"\r\n                strokeWidth={2}\r\n                label={{\r\n                  value: 'Launch',\r\n                  position: 'top',\r\n                  fill: '#F96302',\r\n                  fontSize: 11,\r\n                  fontWeight: 600\r\n                }}\r\n              />\r\n            )}\r\n            {hasComparison && lyDataKey && (\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey={lyDataKey}\r\n                name=\"Last Year\"\r\n                stroke=\"#86868b\"\r\n                strokeWidth={1.5}\r\n                strokeDasharray=\"4 4\"\r\n                fill=\"url(#areaGradientLY)\"\r\n                dot={false}\r\n                activeDot={{ r: 4, fill: '#86868b', stroke: '#fff', strokeWidth: 2 }}\r\n              />\r\n            )}\r\n            <Area\r\n              type=\"monotone\"\r\n              dataKey={tyDataKey}\r\n              name={hasComparison ? \"This Year\" : kpi}\r\n              stroke=\"#F96302\"\r\n              strokeWidth={2}\r\n              fill=\"url(#areaGradientTY)\"\r\n              dot={false}\r\n              activeDot={{ r: 5, fill: '#F96302', stroke: '#fff', strokeWidth: 2 }}\r\n            />\r\n          </AreaChart>\r\n        );\r\n\r\n      case 'bar':\r\n        return (\r\n          <BarChart {...commonProps}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,0,0,0.04)\" vertical={false} />\r\n            <XAxis\r\n              dataKey=\"date\"\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={{ stroke: 'rgba(0,0,0,0.08)' }}\r\n              tickFormatter={formatAxisDate}\r\n              interval=\"preserveStartEnd\"\r\n            />\r\n            <YAxis\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={false}\r\n              tickFormatter={formatValue}\r\n              width={Y_AXIS_WIDTH}\r\n            />\r\n            <Tooltip content={<CustomTooltip />} />\r\n            {hasComparison && <Legend />}\r\n            {launchDate && (\r\n              <ReferenceLine\r\n                x={launchDate}\r\n                stroke=\"#F96302\"\r\n                strokeDasharray=\"4 4\"\r\n                strokeWidth={2}\r\n              />\r\n            )}\r\n            {hasComparison && lyDataKey && (\r\n              <Bar\r\n                dataKey={lyDataKey}\r\n                name=\"Last Year\"\r\n                fill=\"#d1d1d6\"\r\n                radius={[4, 4, 0, 0]}\r\n                maxBarSize={20}\r\n              />\r\n            )}\r\n            <Bar\r\n              dataKey={tyDataKey}\r\n              name={hasComparison ? \"This Year\" : kpi}\r\n              fill=\"#F96302\"\r\n              radius={[4, 4, 0, 0]}\r\n              maxBarSize={hasComparison ? 20 : 40}\r\n            />\r\n          </BarChart>\r\n        );\r\n\r\n      default:\r\n        return (\r\n          <LineChart {...commonProps}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,0,0,0.04)\" vertical={false} />\r\n            <XAxis\r\n              dataKey=\"date\"\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={{ stroke: 'rgba(0,0,0,0.08)' }}\r\n              tickFormatter={formatAxisDate}\r\n              interval=\"preserveStartEnd\"\r\n            />\r\n            <YAxis\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={false}\r\n              tickFormatter={formatValue}\r\n              width={Y_AXIS_WIDTH}\r\n            />\r\n            <Tooltip content={<CustomTooltip />} />\r\n            {hasComparison && <Legend />}\r\n            {launchDate && (\r\n              <ReferenceLine\r\n                x={launchDate}\r\n                stroke=\"#F96302\"\r\n                strokeDasharray=\"4 4\"\r\n                strokeWidth={2}\r\n                label={{\r\n                  value: 'Launch',\r\n                  position: 'top',\r\n                  fill: '#F96302',\r\n                  fontSize: 11,\r\n                  fontWeight: 600\r\n                }}\r\n              />\r\n            )}\r\n            {hasComparison && lyDataKey && (\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey={lyDataKey}\r\n                name=\"Last Year\"\r\n                stroke=\"#86868b\"\r\n                strokeWidth={1.5}\r\n                strokeDasharray=\"4 4\"\r\n                dot={false}\r\n                activeDot={{ r: 4, fill: '#86868b', stroke: '#fff', strokeWidth: 2 }}\r\n              />\r\n            )}\r\n            <Line\r\n              type=\"monotone\"\r\n              dataKey={tyDataKey}\r\n              name={hasComparison ? \"This Year\" : kpi}\r\n              stroke=\"#F96302\"\r\n              strokeWidth={2}\r\n              dot={false}\r\n              activeDot={{ r: 5, fill: '#F96302', stroke: '#fff', strokeWidth: 2 }}\r\n            />\r\n          </LineChart>\r\n        );\r\n    }\r\n  };\r\n\r\n  if (!chartData || chartData.length === 0) {\r\n    return (\r\n      <div className=\"chart-empty\">\r\n        <p>No data available for the selected period</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isBeta) {\r\n    return (\r\n      <div className=\"kpi-chart beta-restricted\">\r\n        <div className=\"chart-blur-wrapper\">\r\n          <ResponsiveContainer width=\"100%\" height={320}>\r\n            {renderChart()}\r\n          </ResponsiveContainer>\r\n        </div>\r\n        <div className=\"beta-overlay\">\r\n          <div className=\"beta-overlay-content\">\r\n            <h3>Place holder</h3>\r\n            <p>Chart visualization</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"kpi-chart-wrapper\">\r\n      <div\r\n        className={`kpi-chart ${draggedTag ? 'drop-active' : ''}`}\r\n        ref={chartContainerRef}\r\n        onDragOver={handleDragOver}\r\n        onDragLeave={handleDragLeave}\r\n        onDrop={handleDrop}\r\n      >\r\n        <ResponsiveContainer width=\"100%\" height={320}>\r\n          {renderChart()}\r\n        </ResponsiveContainer>\r\n\r\n        {/* Placed tags overlay */}\r\n        <div className=\"tags-overlay\">\r\n          {renderPlacedTags()}\r\n        </div>\r\n\r\n        {/* Drag preview overlay */}\r\n        {dragPreview && (\r\n          <div className=\"drag-preview-overlay\">\r\n            {renderDragPreview()}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Tag Panel Toggle */}\r\n      <div className=\"chart-tag-controls\">\r\n        <button\r\n          className={`tag-panel-toggle ${showTagPanel ? 'active' : ''}`}\r\n          onClick={() => setShowTagPanel(!showTagPanel)}\r\n        >\r\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n            <path d=\"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z\"></path>\r\n            <line x1=\"7\" y1=\"7\" x2=\"7.01\" y2=\"7\"></line>\r\n          </svg>\r\n          <span>Add Info Tag</span>\r\n        </button>\r\n\r\n        {/* Active Tags Display */}\r\n        {chartTags && chartTags.length > 0 && (\r\n          <div className=\"active-tags\">\r\n            {chartTags.map(tag => (\r\n              <span\r\n                key={tag.id}\r\n                className=\"active-tag\"\r\n                style={{ borderColor: tag.color, color: tag.color }}\r\n              >\r\n                <span className=\"tag-marker\" style={{ background: tag.color }}></span>\r\n                {tag.name}\r\n                <span className=\"tag-date\">{formatAxisDate(tag.date)}</span>\r\n                <button onClick={() => handleRemoveTag(tag.id)} className=\"tag-remove\">\r\n                  <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\r\n                    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\r\n                  </svg>\r\n                </button>\r\n              </span>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Tag Panel */}\r\n      {showTagPanel && (\r\n        <div className=\"tag-panel\">\r\n          <div className=\"tag-panel-header\">\r\n            <h4>Drag tags onto the chart</h4>\r\n            <button className=\"tag-panel-close\" onClick={() => setShowTagPanel(false)}>\r\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\r\n                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"preset-tags\">\r\n            {PRESET_TAGS.map(tag => (\r\n              <div\r\n                key={tag.id}\r\n                className=\"draggable-tag\"\r\n                draggable\r\n                onDragStart={(e) => handleDragStart(e, tag)}\r\n                onDragEnd={handleDragEnd}\r\n                style={{ borderColor: tag.color }}\r\n              >\r\n                <span className=\"tag-marker\" style={{ background: tag.color }}></span>\r\n                {tag.name}\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"custom-tag-section\">\r\n            {!showCustomForm ? (\r\n              <button\r\n                className=\"add-custom-tag-btn\"\r\n                onClick={() => setShowCustomForm(true)}\r\n              >\r\n                <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line>\r\n                  <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line>\r\n                </svg>\r\n                Create Custom Tag\r\n              </button>\r\n            ) : (\r\n              <div className=\"custom-tag-form\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Tag name\"\r\n                  value={customTagName}\r\n                  onChange={(e) => setCustomTagName(e.target.value)}\r\n                  className=\"custom-tag-input\"\r\n                />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Your name (owner)\"\r\n                  value={customTagOwner}\r\n                  onChange={(e) => setCustomTagOwner(e.target.value)}\r\n                  className=\"custom-tag-input\"\r\n                />\r\n                <div className=\"custom-tag-actions\">\r\n                  <button\r\n                    className=\"custom-tag-cancel\"\r\n                    onClick={() => {\r\n                      setShowCustomForm(false);\r\n                      setCustomTagName('');\r\n                      setCustomTagOwner('');\r\n                    }}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    className=\"custom-tag-create\"\r\n                    onClick={handleAddCustomTag}\r\n                    disabled={!customTagName.trim() || !customTagOwner.trim()}\r\n                  >\r\n                    Create & Drag\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {draggedTag && draggedTag.isCustom && (\r\n            <div className=\"drag-instruction\">\r\n              <p>Now drag your custom tag \"{draggedTag.name}\" onto the chart</p>\r\n              <div\r\n                className=\"draggable-tag custom\"\r\n                draggable\r\n                onDragStart={(e) => handleDragStart(e, draggedTag)}\r\n                onDragEnd={handleDragEnd}\r\n              >\r\n                <span className=\"tag-marker\" style={{ background: draggedTag.color }}></span>\r\n                {draggedTag.name}\r\n                <span className=\"tag-owner\">by {draggedTag.owner}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default KPIChart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}