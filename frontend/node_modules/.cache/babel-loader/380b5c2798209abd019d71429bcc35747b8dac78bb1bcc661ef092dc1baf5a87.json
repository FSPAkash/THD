{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\AkashPatil\\\\THD-Dashboard\\\\frontend\\\\src\\\\components\\\\KPIChart.js\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useCallback, useEffect } from 'react';\nimport { LineChart, Line, AreaChart, Area, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine, Legend } from 'recharts';\nimport { useAuth } from '../context/AuthContext';\nimport './KPIChart.css';\n\n// Preset event tags - these are for manual tagging of events NOT in the Event Tracker\n// Events like Black Friday, Labor Day, etc. come from the Event Tracker automatically\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PRESET_TAGS = [{\n  id: 'thanksgiving',\n  name: 'Thanksgiving',\n  color: '#F96302'\n}, {\n  id: 'july4th',\n  name: '4th of July',\n  color: '#FF3B30'\n}, {\n  id: 'tier1',\n  name: 'Tier 1 Event',\n  color: '#5856D6'\n}, {\n  id: 'promo',\n  name: 'Promo',\n  color: '#34C759'\n}, {\n  id: 'outage',\n  name: 'Outage/Issue',\n  color: '#FF2D55'\n}];\n\n// Chart margins matching Recharts config\nconst CHART_MARGINS = {\n  top: 20,\n  right: 20,\n  left: 10,\n  bottom: 20\n};\nconst Y_AXIS_WIDTH = 60;\nconst CHART_HEIGHT = 320;\n// Height of the actual plot area (excluding X-axis labels ~30px and Legend ~24px)\nconst PLOT_AREA_HEIGHT = CHART_HEIGHT - CHART_MARGINS.top - CHART_MARGINS.bottom - 54;\n\n// Convert hex color string to rgba with given alpha\nfunction hexToRgba(hex, alpha) {\n  const r = parseInt(hex.slice(1, 3), 16);\n  const g = parseInt(hex.slice(3, 5), 16);\n  const b = parseInt(hex.slice(5, 7), 16);\n  return `rgba(${r},${g},${b},${alpha})`;\n}\nfunction KPIChart({\n  data,\n  kpi,\n  chartType,\n  format,\n  launchDate,\n  comparisonData,\n  chartTags,\n  onTagsChange,\n  displayMode = 'both',\n  events = []\n}) {\n  _s();\n  const {\n    isBetaMode\n  } = useAuth();\n  const isBeta = isBetaMode();\n  const chartContainerRef = useRef(null);\n  const [showTagPanel, setShowTagPanel] = useState(false);\n  const [customTagName, setCustomTagName] = useState('');\n  const [customTagOwner, setCustomTagOwner] = useState('');\n  const [customTagDescription, setCustomTagDescription] = useState('');\n  const [draggedTag, setDraggedTag] = useState(null);\n  const [showCustomForm, setShowCustomForm] = useState(false);\n  const [dragPreview, setDragPreview] = useState(null);\n  const [containerWidth, setContainerWidth] = useState(0);\n  const [expandedTagId, setExpandedTagId] = useState(null);\n  const [showSuggestedEvents, setShowSuggestedEvents] = useState(false);\n  const [dismissedEvents, setDismissedEvents] = useState(() => {\n    try {\n      const stored = sessionStorage.getItem('dismissedEvents');\n      return stored ? JSON.parse(stored) : [];\n    } catch {\n      return [];\n    }\n  });\n  const [editingEvent, setEditingEvent] = useState(null);\n\n  // Use comparison data if available, otherwise fall back to regular data\n  const rawChartData = comparisonData && comparisonData.length > 0 ? comparisonData : data;\n  const hasComparison = comparisonData && comparisonData.length > 0;\n\n  // Add displayDate field based on displayMode\n  // When showing LY only, use date_ly for X-axis; otherwise use date (TY)\n  const chartData = (rawChartData === null || rawChartData === void 0 ? void 0 : rawChartData.map(d => ({\n    ...d,\n    displayDate: displayMode === 'ly' && d.date_ly ? d.date_ly : d.date\n  }))) || [];\n\n  // Track container width for tag positioning\n  useEffect(() => {\n    const updateWidth = () => {\n      if (chartContainerRef.current) {\n        const width = chartContainerRef.current.offsetWidth;\n        if (width > 0) {\n          setContainerWidth(width);\n        }\n      }\n    };\n\n    // Initial update with a slight delay to ensure DOM is ready\n    updateWidth();\n    const initialTimeout = setTimeout(updateWidth, 100);\n    const secondTimeout = setTimeout(updateWidth, 300);\n    window.addEventListener('resize', updateWidth);\n\n    // Also observe size changes\n    const resizeObserver = new ResizeObserver(() => {\n      // Use requestAnimationFrame to avoid layout thrashing\n      requestAnimationFrame(() => {\n        updateWidth();\n      });\n    });\n    if (chartContainerRef.current) {\n      resizeObserver.observe(chartContainerRef.current);\n    }\n    return () => {\n      clearTimeout(initialTimeout);\n      clearTimeout(secondTimeout);\n      window.removeEventListener('resize', updateWidth);\n      resizeObserver.disconnect();\n    };\n  }, []);\n\n  // Force width recalculation when chartTags change (ensures tags render properly)\n  useEffect(() => {\n    if (chartTags && chartTags.length > 0 && chartContainerRef.current) {\n      const width = chartContainerRef.current.offsetWidth;\n      if (width > 0 && containerWidth !== width) {\n        setContainerWidth(width);\n      }\n    }\n  }, [chartTags, containerWidth]);\n  const formatValue = val => {\n    if (val === null || val === undefined || isNaN(val)) return '-';\n    if (format === 'currency') {\n      if (Math.abs(val) >= 1000000) {\n        return `$${(val / 1000000).toFixed(1)}M`;\n      }\n      if (Math.abs(val) >= 1000) {\n        return `$${(val / 1000).toFixed(0)}K`;\n      }\n      return `$${val.toFixed(2)}`;\n    }\n    if (format === 'percentage') {\n      return `${(val * 100).toFixed(2)}%`;\n    }\n    if (Math.abs(val) >= 1000000) {\n      return `${(val / 1000000).toFixed(1)}M`;\n    }\n    if (Math.abs(val) >= 1000) {\n      return `${(val / 1000).toFixed(0)}K`;\n    }\n    return val.toLocaleString();\n  };\n  const formatAxisDate = dateStr => {\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric'\n    });\n  };\n  const formatFullDate = dateStr => {\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('en-US', {\n      weekday: 'short',\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric'\n    });\n  };\n\n  // Get container rect - always fresh to handle dynamic sizing\n  const getContainerRect = useCallback(() => {\n    if (!chartContainerRef.current) return null;\n    return chartContainerRef.current.getBoundingClientRect();\n  }, []);\n\n  // Calculate date index from clientX position\n  const getDateIndexFromX = useCallback(clientX => {\n    if (!chartData || chartData.length === 0) return -1;\n    const rect = getContainerRect();\n    if (!rect) return -1;\n    const chartAreaLeft = Y_AXIS_WIDTH + CHART_MARGINS.left;\n    const chartAreaWidth = rect.width - chartAreaLeft - CHART_MARGINS.right;\n    const relativeX = clientX - rect.left - chartAreaLeft;\n    const percentage = Math.max(0, Math.min(1, relativeX / chartAreaWidth));\n    const dataIndex = Math.round(percentage * (chartData.length - 1));\n    return Math.max(0, Math.min(dataIndex, chartData.length - 1));\n  }, [chartData, getContainerRect]);\n\n  // Get x position (relative to container) for a data index\n  const getXPositionForIndex = useCallback(index => {\n    var _chartContainerRef$cu;\n    if (!chartData || chartData.length === 0 || index < 0) return 0;\n\n    // Use containerWidth state for reliable positioning\n    const width = containerWidth || ((_chartContainerRef$cu = chartContainerRef.current) === null || _chartContainerRef$cu === void 0 ? void 0 : _chartContainerRef$cu.offsetWidth) || 0;\n    if (width === 0) return 0;\n    const chartAreaLeft = Y_AXIS_WIDTH + CHART_MARGINS.left;\n    const chartAreaWidth = width - chartAreaLeft - CHART_MARGINS.right;\n\n    // Handle single data point\n    if (chartData.length === 1) {\n      return chartAreaLeft + chartAreaWidth / 2;\n    }\n    const percentage = index / (chartData.length - 1);\n    return chartAreaLeft + percentage * chartAreaWidth;\n  }, [chartData, containerWidth]);\n  const CustomTooltip = ({\n    active,\n    payload,\n    label\n  }) => {\n    if (active && payload && payload.length) {\n      const dateStr = new Date(label).toLocaleDateString('en-US', {\n        weekday: 'short',\n        month: 'short',\n        day: 'numeric',\n        year: 'numeric'\n      });\n\n      // Check if there's a tag for this date\n      const dateTag = chartTags === null || chartTags === void 0 ? void 0 : chartTags.find(t => t.date === label);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-tooltip\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"tooltip-date\",\n          children: dateStr\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this), dateTag && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"tooltip-tag\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tooltip-tag-marker\",\n            style: {\n              background: dateTag.color\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 15\n          }, this), dateTag.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this), payload.map((entry, index) => /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"tooltip-value\",\n          style: {\n            color: entry.color\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tooltip-label\",\n            children: [entry.name, \": \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 15\n          }, this), formatValue(entry.value)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this);\n    }\n    return null;\n  };\n  const handleDragStart = (e, tag) => {\n    setDraggedTag(tag);\n    e.dataTransfer.effectAllowed = 'copy';\n    // Set a transparent drag image\n    const img = new Image();\n    img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n    e.dataTransfer.setDragImage(img, 0, 0);\n  };\n  const handleDragOver = e => {\n    var _chartData$dateIndex;\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'copy';\n    if (!draggedTag || !chartData || chartData.length === 0) return;\n    const rect = getContainerRect();\n    if (!rect) return;\n    const dateIndex = getDateIndexFromX(e.clientX);\n    const targetDate = (_chartData$dateIndex = chartData[dateIndex]) === null || _chartData$dateIndex === void 0 ? void 0 : _chartData$dateIndex.date;\n\n    // Calculate position relative to container for display\n    const xPosition = getXPositionForIndex(dateIndex);\n    if (targetDate && dateIndex >= 0) {\n      setDragPreview({\n        date: targetDate,\n        formattedDate: formatFullDate(targetDate),\n        x: xPosition,\n        index: dateIndex,\n        tag: draggedTag\n      });\n    }\n  };\n  const handleDragLeave = e => {\n    var _chartContainerRef$cu2;\n    // Only clear preview if we're actually leaving the chart area\n    const rect = (_chartContainerRef$cu2 = chartContainerRef.current) === null || _chartContainerRef$cu2 === void 0 ? void 0 : _chartContainerRef$cu2.getBoundingClientRect();\n    if (rect) {\n      const {\n        clientX,\n        clientY\n      } = e;\n      if (clientX < rect.left || clientX > rect.right || clientY < rect.top || clientY > rect.bottom) {\n        setDragPreview(null);\n      }\n    }\n  };\n  const handleDrop = e => {\n    var _chartData$dateIndex2;\n    e.preventDefault();\n    if (!draggedTag || !chartData || chartData.length === 0) return;\n    const dateIndex = getDateIndexFromX(e.clientX);\n    const targetDate = (_chartData$dateIndex2 = chartData[dateIndex]) === null || _chartData$dateIndex2 === void 0 ? void 0 : _chartData$dateIndex2.date;\n    if (targetDate) {\n      const newTag = {\n        ...draggedTag,\n        id: `${draggedTag.id}-${Date.now()}`,\n        date: targetDate,\n        dateIndex: dateIndex\n      };\n      if (onTagsChange) {\n        onTagsChange([...(chartTags || []), newTag]);\n      }\n    }\n    setDraggedTag(null);\n    setDragPreview(null);\n  };\n  const handleDragEnd = () => {\n    setDragPreview(null);\n  };\n  const handleAddCustomTag = () => {\n    if (!customTagName.trim() || !customTagOwner.trim()) return;\n    const newTag = {\n      id: `custom-${Date.now()}`,\n      name: customTagName.trim(),\n      owner: customTagOwner.trim(),\n      description: customTagDescription.trim() || '',\n      color: '#6e6e73',\n      isCustom: true\n    };\n    setDraggedTag(newTag);\n    setCustomTagName('');\n    setCustomTagOwner('');\n    setCustomTagDescription('');\n    setShowCustomForm(false);\n  };\n  const handleTagClick = tagId => {\n    setExpandedTagId(expandedTagId === tagId ? null : tagId);\n  };\n  const handleRemoveTag = tagId => {\n    if (onTagsChange) {\n      onTagsChange((chartTags || []).filter(t => t.id !== tagId));\n    }\n  };\n\n  // Persist dismissedEvents to sessionStorage whenever they change\n  useEffect(() => {\n    try {\n      sessionStorage.setItem('dismissedEvents', JSON.stringify(dismissedEvents));\n    } catch {/* ignore */}\n  }, [dismissedEvents]);\n\n  // Dismiss a suggested event (session-scoped)\n  const handleDismissEvent = eventId => {\n    setDismissedEvents(prev => [...prev, eventId]);\n  };\n\n  // Reset all dismissed events\n  const handleResetDismissed = () => {\n    setDismissedEvents([]);\n  };\n\n  // Get list of pinned event IDs from chartTags\n  const pinnedEventIds = (chartTags || []).filter(tag => tag.sourceEventId).map(tag => tag.sourceEventId);\n\n  // Year-aware event filtering: returns events adjusted to the visible chart date range\n  // Excludes dismissed and pinned events\n  const getFilteredEvents = useCallback(() => {\n    var _chartData$, _chartData;\n    if (!events || events.length === 0 || !chartData || chartData.length === 0) return [];\n    const chartStartDate = (_chartData$ = chartData[0]) === null || _chartData$ === void 0 ? void 0 : _chartData$.date;\n    const chartEndDate = (_chartData = chartData[chartData.length - 1]) === null || _chartData === void 0 ? void 0 : _chartData.date;\n    if (!chartStartDate || !chartEndDate) return [];\n    const chartStart = new Date(chartStartDate + 'T00:00:00');\n    const chartEnd = new Date(chartEndDate + 'T00:00:00');\n\n    // Determine year label suffix based on displayMode\n    const yearLabel = displayMode === 'ly' ? 'LY' : 'TY';\n    return events.filter(ev => !dismissedEvents.includes(ev.id)).filter(ev => !pinnedEventIds.includes(ev.id)) // Exclude pinned events\n    .map(ev => {\n      let evStart = new Date(ev.startDate + 'T00:00:00');\n      let evEnd = new Date(ev.endDate + 'T00:00:00');\n\n      // When showing LY only, shift event dates back 365 days\n      if (displayMode === 'ly') {\n        evStart = new Date(evStart.getTime() - 365 * 24 * 60 * 60 * 1000);\n        evEnd = new Date(evEnd.getTime() - 365 * 24 * 60 * 60 * 1000);\n      }\n      return {\n        ...ev,\n        adjustedStart: evStart,\n        adjustedEnd: evEnd,\n        yearLabel\n      };\n    }).filter(ev => {\n      // Keep only events that overlap with the visible chart range\n      return ev.adjustedStart <= chartEnd && ev.adjustedEnd >= chartStart;\n    });\n  }, [events, chartData, displayMode, dismissedEvents, pinnedEventIds]);\n\n  // Convert a date to the nearest data index in chartData\n  const getIndexForDate = useCallback(targetDate => {\n    if (!chartData || chartData.length === 0) return -1;\n    let bestIdx = 0;\n    let bestDiff = Infinity;\n    for (let i = 0; i < chartData.length; i++) {\n      const d = new Date(chartData[i].date + 'T00:00:00');\n      const diff = Math.abs(d.getTime() - targetDate.getTime());\n      if (diff < bestDiff) {\n        bestDiff = diff;\n        bestIdx = i;\n      }\n    }\n    return bestIdx;\n  }, [chartData]);\n\n  // Helper to render a single event span (used for both suggestions and pinned)\n  const renderSingleSpan = (ev, isPinned = false) => {\n    var _chartContainerRef$cu3;\n    const currentWidth = containerWidth || ((_chartContainerRef$cu3 = chartContainerRef.current) === null || _chartContainerRef$cu3 === void 0 ? void 0 : _chartContainerRef$cu3.offsetWidth) || 0;\n    if (currentWidth === 0) return null;\n    const chartAreaLeft = Y_AXIS_WIDTH + CHART_MARGINS.left;\n    const chartAreaWidth = currentWidth - chartAreaLeft - CHART_MARGINS.right;\n\n    // For pinned spans, adjustedStart/End are stored as ISO strings\n    const evStart = isPinned ? new Date(ev.adjustedStart) : ev.adjustedStart;\n    const evEnd = isPinned ? new Date(ev.adjustedEnd) : ev.adjustedEnd;\n    const startIdx = getIndexForDate(evStart);\n    const endIdx = getIndexForDate(evEnd);\n\n    // Clamp indices to chart bounds\n    const clampedStart = Math.max(0, startIdx);\n    const clampedEnd = Math.min(chartData.length - 1, endIdx);\n\n    // Calculate pixel positions\n    const startPct = chartData.length === 1 ? 0.5 : clampedStart / (chartData.length - 1);\n    const endPct = chartData.length === 1 ? 0.5 : clampedEnd / (chartData.length - 1);\n    const leftPx = chartAreaLeft + startPct * chartAreaWidth;\n    const rightPx = chartAreaLeft + endPct * chartAreaWidth;\n    const widthPx = Math.max(rightPx - leftPx, 4); // minimum 4px width\n\n    const centerPx = leftPx + widthPx / 2;\n\n    // Solid fill with edge borders - cleaner than gradient\n    const fillColor = hexToRgba(ev.color, 0.12);\n    const borderColor = hexToRgba(ev.color, 0.5);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `event-span ${isPinned ? 'pinned' : ''}`,\n      style: {\n        left: `${leftPx}px`,\n        width: `${widthPx}px`,\n        background: fillColor,\n        borderLeft: `2px solid ${borderColor}`,\n        borderRight: `2px solid ${borderColor}`\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"event-span-label\",\n        style: {\n          left: `${centerPx - leftPx}px`,\n          background: ev.color\n        },\n        onClick: () => !isPinned && setEditingEvent((editingEvent === null || editingEvent === void 0 ? void 0 : editingEvent.id) === ev.id ? null : ev),\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"event-span-label-text\",\n          children: [ev.name || ev.label, \" (\", ev.yearLabel, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 11\n        }, this), isPinned ? /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"event-span-dismiss\",\n          onClick: e => {\n            e.stopPropagation();\n            handleRemoveTag(ev.id);\n          },\n          title: \"Remove\",\n          children: \"x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"event-span-dismiss\",\n          onClick: e => {\n            e.stopPropagation();\n            handleDismissEvent(ev.id);\n          },\n          title: \"Dismiss\",\n          children: \"x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 9\n      }, this), !isPinned && (editingEvent === null || editingEvent === void 0 ? void 0 : editingEvent.id) === ev.id && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"event-span-edit\",\n        style: {\n          left: `${centerPx - leftPx}px`\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"event-span-edit-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: ev.label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"event-span-edit-close\",\n            onClick: () => setEditingEvent(null),\n            children: \"x\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"event-span-edit-dates\",\n          children: [new Date(ev.adjustedStart).toLocaleDateString('en-US', {\n            month: 'short',\n            day: 'numeric'\n          }), ' - ', new Date(ev.adjustedEnd).toLocaleDateString('en-US', {\n            month: 'short',\n            day: 'numeric'\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"event-span-edit-tier\",\n          children: ev.tier ? 'Tier 1 Event' : 'Tracked Event'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"event-span-pin-btn\",\n          onClick: () => {\n            // Pin as a permanent span (not point marker) with full event data\n            if (onTagsChange) {\n              onTagsChange([...(chartTags || []), {\n                id: `pinned-${ev.id}-${Date.now()}`,\n                name: ev.label,\n                color: ev.color,\n                // Store the original event ID to track which event was pinned\n                sourceEventId: ev.id,\n                // Store span data for rendering as a span\n                isSpan: true,\n                startDate: ev.startDate,\n                endDate: ev.endDate,\n                adjustedStart: ev.adjustedStart.toISOString(),\n                adjustedEnd: ev.adjustedEnd.toISOString(),\n                yearLabel: ev.yearLabel,\n                tier: ev.tier,\n                source: 'suggested'\n              }]);\n            }\n            setEditingEvent(null);\n          },\n          children: \"Pin to chart\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 11\n      }, this)]\n    }, ev.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Get pinned span tags that overlap with current chart range\n  const getPinnedSpans = useCallback(() => {\n    var _chartData$2, _chartData2;\n    if (!chartTags || !chartData || chartData.length === 0) return [];\n    const chartStartDate = (_chartData$2 = chartData[0]) === null || _chartData$2 === void 0 ? void 0 : _chartData$2.date;\n    const chartEndDate = (_chartData2 = chartData[chartData.length - 1]) === null || _chartData2 === void 0 ? void 0 : _chartData2.date;\n    if (!chartStartDate || !chartEndDate) return [];\n    const chartStart = new Date(chartStartDate + 'T00:00:00');\n    const chartEnd = new Date(chartEndDate + 'T00:00:00');\n    return chartTags.filter(tag => tag.isSpan).filter(tag => {\n      const tagStart = new Date(tag.adjustedStart);\n      const tagEnd = new Date(tag.adjustedEnd);\n      return tagStart <= chartEnd && tagEnd >= chartStart;\n    });\n  }, [chartTags, chartData]);\n\n  // Render gradient event spans behind the chart (both suggestions and pinned)\n  const renderEventSpans = () => {\n    var _chartContainerRef$cu4;\n    const currentWidth = containerWidth || ((_chartContainerRef$cu4 = chartContainerRef.current) === null || _chartContainerRef$cu4 === void 0 ? void 0 : _chartContainerRef$cu4.offsetWidth) || 0;\n    if (currentWidth === 0) return null;\n\n    // Get pinned spans (always show)\n    const pinnedSpans = getPinnedSpans();\n\n    // Get suggested events (only when toggle is on)\n    const suggestedEvents = showSuggestedEvents ? getFilteredEvents() : [];\n\n    // If nothing to render, return null\n    if (pinnedSpans.length === 0 && suggestedEvents.length === 0) return null;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [pinnedSpans.map(span => renderSingleSpan(span, true)), suggestedEvents.map(ev => renderSingleSpan(ev, false))]\n    }, void 0, true);\n  };\n  const commonProps = {\n    data: chartData,\n    margin: CHART_MARGINS\n  };\n  const axisStyle = {\n    fontSize: 11,\n    fill: '#86868b',\n    fontWeight: 500\n  };\n\n  // Calculate tick interval for evenly spaced X-axis labels\n  // Target ~6-8 ticks for readability, ensuring even spacing\n  const calculateTickInterval = () => {\n    if (!chartData || chartData.length <= 1) return 0;\n    const dataPoints = chartData.length;\n    const targetTicks = 7; // Aim for 7 evenly spaced ticks\n    const interval = Math.max(0, Math.floor((dataPoints - 1) / (targetTicks - 1)) - 1);\n    return interval;\n  };\n  const tickInterval = calculateTickInterval();\n\n  // Get the correct data keys based on comparison mode\n  const tyDataKey = hasComparison ? `${kpi}_ty` : kpi;\n  const lyDataKey = hasComparison ? `${kpi}_ly` : null;\n\n  // Determine which lines to show based on displayMode\n  const showTY = displayMode === 'both' || displayMode === 'ty';\n  const showLY = displayMode === 'both' || displayMode === 'ly';\n\n  // Render placed tags as overlay elements (point tags only, not span tags)\n  const renderPlacedTags = () => {\n    var _chartContainerRef$cu5;\n    if (!chartTags || chartTags.length === 0 || !chartData || chartData.length === 0) return null;\n\n    // Filter out span tags - they're rendered in renderEventSpans\n    const pointTags = chartTags.filter(t => !t.isSpan);\n    if (pointTags.length === 0) return null;\n\n    // Get current width - fallback to ref if state is 0\n    const currentWidth = containerWidth || ((_chartContainerRef$cu5 = chartContainerRef.current) === null || _chartContainerRef$cu5 === void 0 ? void 0 : _chartContainerRef$cu5.offsetWidth) || 0;\n    if (currentWidth === 0) return null;\n\n    // Pole extends from tag area into chart\n    const poleHeight = CHART_HEIGHT - CHART_MARGINS.bottom - 40;\n    return pointTags.map(tag => {\n      // Find the date index - use stored index first, then lookup by date\n      let dateIndex = tag.dateIndex;\n      if (dateIndex === undefined || dateIndex < 0 || dateIndex >= chartData.length) {\n        dateIndex = chartData.findIndex(d => d.date === tag.date);\n      }\n      if (dateIndex === -1 || dateIndex >= chartData.length) return null;\n      const xPos = getXPositionForIndex(dateIndex);\n      if (xPos === 0 && dateIndex !== 0) return null; // Position calculation failed\n\n      const isExpanded = expandedTagId === tag.id;\n      const hasDetails = tag.owner || tag.description;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `placed-tag-container ${isExpanded ? 'expanded' : ''}`,\n        style: {\n          left: `${xPos}px`\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: `tag-label ${hasDetails ? 'clickable' : ''}`,\n          style: {\n            background: tag.color\n          },\n          onClick: hasDetails ? () => handleTagClick(tag.id) : undefined,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag-label-text\",\n            children: tag.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 645,\n            columnNumber: 13\n          }, this), hasDetails && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag-expand-icon\",\n            children: isExpanded ? 'âˆ’' : '+'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 647,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"tag-label-remove\",\n            onClick: e => {\n              e.stopPropagation();\n              handleRemoveTag(tag.id);\n            },\n            title: \"Remove tag\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 651,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 640,\n          columnNumber: 11\n        }, this), isExpanded && hasDetails && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tag-details\",\n          style: {\n            borderColor: tag.color\n          },\n          children: [tag.description && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"tag-description\",\n            children: tag.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 667,\n            columnNumber: 17\n          }, this), tag.owner && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"tag-owner-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"tag-owner-label\",\n              children: \"Owner:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 671,\n              columnNumber: 19\n            }, this), \" \", tag.owner]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 670,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 665,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tag-pole\",\n          style: {\n            background: tag.color,\n            height: poleHeight\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 678,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tag-date\",\n          style: {\n            color: tag.color\n          },\n          children: formatAxisDate(tag.date)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 686,\n          columnNumber: 11\n        }, this)]\n      }, tag.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 634,\n        columnNumber: 9\n      }, this);\n    });\n  };\n\n  // Render drag preview\n  const renderDragPreview = () => {\n    if (!dragPreview || dragPreview.x === 0) return null;\n    const poleHeight = CHART_HEIGHT - CHART_MARGINS.bottom - 40;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"drag-preview-container\",\n      style: {\n        left: `${dragPreview.x}px`\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tag-label preview\",\n        style: {\n          background: dragPreview.tag.color\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"tag-label-text\",\n          children: dragPreview.tag.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 707,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 706,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tag-pole preview\",\n        style: {\n          borderColor: dragPreview.tag.color,\n          height: poleHeight\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 710,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tag-date preview\",\n        style: {\n          color: dragPreview.tag.color\n        },\n        children: dragPreview.formattedDate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 718,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 701,\n      columnNumber: 7\n    }, this);\n  };\n  const renderChart = () => {\n    switch (chartType) {\n      case 'area':\n        return /*#__PURE__*/_jsxDEV(AreaChart, {\n          ...commonProps,\n          children: [/*#__PURE__*/_jsxDEV(\"defs\", {\n            children: [/*#__PURE__*/_jsxDEV(\"linearGradient\", {\n              id: \"areaGradientTY\",\n              x1: \"0\",\n              y1: \"0\",\n              x2: \"0\",\n              y2: \"1\",\n              children: [/*#__PURE__*/_jsxDEV(\"stop\", {\n                offset: \"0%\",\n                stopColor: \"#F96302\",\n                stopOpacity: 0.25\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 732,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"stop\", {\n                offset: \"100%\",\n                stopColor: \"#F96302\",\n                stopOpacity: 0\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 733,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 731,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"linearGradient\", {\n              id: \"areaGradientLY\",\n              x1: \"0\",\n              y1: \"0\",\n              x2: \"0\",\n              y2: \"1\",\n              children: [/*#__PURE__*/_jsxDEV(\"stop\", {\n                offset: \"0%\",\n                stopColor: \"#86868b\",\n                stopOpacity: 0.15\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 736,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"stop\", {\n                offset: \"100%\",\n                stopColor: \"#86868b\",\n                stopOpacity: 0\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 737,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 735,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 730,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CartesianGrid, {\n            strokeDasharray: \"3 3\",\n            stroke: \"rgba(0,0,0,0.04)\",\n            vertical: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 740,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n            dataKey: \"date\",\n            tick: axisStyle,\n            tickLine: false,\n            axisLine: {\n              stroke: 'rgba(0,0,0,0.08)'\n            },\n            tickFormatter: formatAxisDate,\n            interval: tickInterval\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 741,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n            tick: axisStyle,\n            tickLine: false,\n            axisLine: false,\n            tickFormatter: formatValue,\n            width: Y_AXIS_WIDTH\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 749,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n            content: /*#__PURE__*/_jsxDEV(CustomTooltip, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 756,\n              columnNumber: 31\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 756,\n            columnNumber: 13\n          }, this), hasComparison && /*#__PURE__*/_jsxDEV(Legend, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 757,\n            columnNumber: 31\n          }, this), launchDate && /*#__PURE__*/_jsxDEV(ReferenceLine, {\n            x: launchDate,\n            stroke: \"#F96302\",\n            strokeDasharray: \"4 4\",\n            strokeWidth: 2,\n            label: {\n              value: 'Launch',\n              position: 'top',\n              fill: '#F96302',\n              fontSize: 11,\n              fontWeight: 600\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 759,\n            columnNumber: 15\n          }, this), hasComparison && lyDataKey && showLY && /*#__PURE__*/_jsxDEV(Area, {\n            type: \"monotone\",\n            dataKey: lyDataKey,\n            name: \"Last Year\",\n            stroke: \"#86868b\",\n            strokeWidth: 1.5,\n            strokeDasharray: \"4 4\",\n            fill: \"url(#areaGradientLY)\",\n            dot: false,\n            activeDot: {\n              r: 4,\n              fill: '#86868b',\n              stroke: '#fff',\n              strokeWidth: 2\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 774,\n            columnNumber: 15\n          }, this), showTY && /*#__PURE__*/_jsxDEV(Area, {\n            type: \"monotone\",\n            dataKey: tyDataKey,\n            name: hasComparison ? \"This Year\" : kpi,\n            stroke: \"#F96302\",\n            strokeWidth: 2,\n            fill: \"url(#areaGradientTY)\",\n            dot: false,\n            activeDot: {\n              r: 5,\n              fill: '#F96302',\n              stroke: '#fff',\n              strokeWidth: 2\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 787,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 729,\n          columnNumber: 11\n        }, this);\n      case 'bar':\n        return /*#__PURE__*/_jsxDEV(BarChart, {\n          ...commonProps,\n          children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n            strokeDasharray: \"3 3\",\n            stroke: \"rgba(0,0,0,0.04)\",\n            vertical: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 804,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n            dataKey: \"date\",\n            tick: axisStyle,\n            tickLine: false,\n            axisLine: {\n              stroke: 'rgba(0,0,0,0.08)'\n            },\n            tickFormatter: formatAxisDate,\n            interval: tickInterval\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 805,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n            tick: axisStyle,\n            tickLine: false,\n            axisLine: false,\n            tickFormatter: formatValue,\n            width: Y_AXIS_WIDTH\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 813,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n            content: /*#__PURE__*/_jsxDEV(CustomTooltip, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 820,\n              columnNumber: 31\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 820,\n            columnNumber: 13\n          }, this), hasComparison && /*#__PURE__*/_jsxDEV(Legend, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 821,\n            columnNumber: 31\n          }, this), launchDate && /*#__PURE__*/_jsxDEV(ReferenceLine, {\n            x: launchDate,\n            stroke: \"#F96302\",\n            strokeDasharray: \"4 4\",\n            strokeWidth: 2\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 823,\n            columnNumber: 15\n          }, this), hasComparison && lyDataKey && showLY && /*#__PURE__*/_jsxDEV(Bar, {\n            dataKey: lyDataKey,\n            name: \"Last Year\",\n            fill: \"#d1d1d6\",\n            radius: [4, 4, 0, 0],\n            maxBarSize: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 831,\n            columnNumber: 15\n          }, this), showTY && /*#__PURE__*/_jsxDEV(Bar, {\n            dataKey: tyDataKey,\n            name: hasComparison ? \"This Year\" : kpi,\n            fill: \"#F96302\",\n            radius: [4, 4, 0, 0],\n            maxBarSize: hasComparison ? 20 : 40\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 840,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 803,\n          columnNumber: 11\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(LineChart, {\n          ...commonProps,\n          children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n            strokeDasharray: \"3 3\",\n            stroke: \"rgba(0,0,0,0.04)\",\n            vertical: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 854,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n            dataKey: \"date\",\n            tick: axisStyle,\n            tickLine: false,\n            axisLine: {\n              stroke: 'rgba(0,0,0,0.08)'\n            },\n            tickFormatter: formatAxisDate,\n            interval: tickInterval\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 855,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n            tick: axisStyle,\n            tickLine: false,\n            axisLine: false,\n            tickFormatter: formatValue,\n            width: Y_AXIS_WIDTH\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 863,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n            content: /*#__PURE__*/_jsxDEV(CustomTooltip, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 870,\n              columnNumber: 31\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 870,\n            columnNumber: 13\n          }, this), hasComparison && /*#__PURE__*/_jsxDEV(Legend, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 871,\n            columnNumber: 31\n          }, this), launchDate && /*#__PURE__*/_jsxDEV(ReferenceLine, {\n            x: launchDate,\n            stroke: \"#F96302\",\n            strokeDasharray: \"4 4\",\n            strokeWidth: 2,\n            label: {\n              value: 'Launch',\n              position: 'top',\n              fill: '#F96302',\n              fontSize: 11,\n              fontWeight: 600\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 873,\n            columnNumber: 15\n          }, this), hasComparison && lyDataKey && showLY && /*#__PURE__*/_jsxDEV(Line, {\n            type: \"monotone\",\n            dataKey: lyDataKey,\n            name: \"Last Year\",\n            stroke: \"#86868b\",\n            strokeWidth: 1.5,\n            strokeDasharray: \"4 4\",\n            dot: false,\n            activeDot: {\n              r: 4,\n              fill: '#86868b',\n              stroke: '#fff',\n              strokeWidth: 2\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 888,\n            columnNumber: 15\n          }, this), showTY && /*#__PURE__*/_jsxDEV(Line, {\n            type: \"monotone\",\n            dataKey: tyDataKey,\n            name: hasComparison ? \"This Year\" : kpi,\n            stroke: \"#F96302\",\n            strokeWidth: 2,\n            dot: false,\n            activeDot: {\n              r: 5,\n              fill: '#F96302',\n              stroke: '#fff',\n              strokeWidth: 2\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 900,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 853,\n          columnNumber: 11\n        }, this);\n    }\n  };\n  if (!chartData || chartData.length === 0) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-empty\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No data available for the selected period\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 918,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 917,\n      columnNumber: 7\n    }, this);\n  }\n  if (isBeta) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"kpi-chart beta-restricted\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-blur-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n          width: \"100%\",\n          height: 320,\n          children: renderChart()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 927,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 926,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"beta-overlay\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"beta-overlay-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Place holder\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 933,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Chart visualization\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 934,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 932,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 931,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 925,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"kpi-chart-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `kpi-chart ${draggedTag ? 'drop-active' : ''}`,\n      ref: chartContainerRef,\n      onDragOver: handleDragOver,\n      onDragLeave: handleDragLeave,\n      onDrop: handleDrop,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tag-area\",\n        children: [renderPlacedTags(), dragPreview && renderDragPreview()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 951,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"event-spans-layer\",\n        style: {\n          height: `${PLOT_AREA_HEIGHT}px`\n        },\n        children: renderEventSpans()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 957,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n        width: \"100%\",\n        height: 320,\n        children: renderChart()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 962,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 943,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-tag-controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tag-panel-toggle ${showTagPanel ? 'active' : ''}`,\n        onClick: () => setShowTagPanel(!showTagPanel),\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 24 24\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          strokeWidth: \"2\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          children: [/*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 974,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n            x1: \"7\",\n            y1: \"7\",\n            x2: \"7.01\",\n            y2: \"7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 975,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 973,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Add Info Tag\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 977,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 969,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `suggested-events-toggle ${showSuggestedEvents ? 'active' : ''}`,\n        onClick: () => setShowSuggestedEvents(!showSuggestedEvents),\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: `suggested-events-dot ${showSuggestedEvents ? 'on' : 'off'}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 985,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Suggested Events\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 986,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 981,\n        columnNumber: 9\n      }, this), chartTags && chartTags.filter(t => !t.isSpan).length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"active-tags\",\n        children: chartTags.filter(t => !t.isSpan).map(tag => /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"active-tag\",\n          style: {\n            borderColor: tag.color,\n            color: tag.color\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag-marker\",\n            style: {\n              background: tag.color\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 998,\n            columnNumber: 17\n          }, this), tag.name, /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag-date\",\n            children: formatAxisDate(tag.date)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1000,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleRemoveTag(tag.id),\n            className: \"tag-remove\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              width: \"12\",\n              height: \"12\",\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              strokeWidth: \"2\",\n              children: [/*#__PURE__*/_jsxDEV(\"line\", {\n                x1: \"18\",\n                y1: \"6\",\n                x2: \"6\",\n                y2: \"18\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1003,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                x1: \"6\",\n                y1: \"6\",\n                x2: \"18\",\n                y2: \"18\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1004,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1002,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1001,\n            columnNumber: 17\n          }, this)]\n        }, tag.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 993,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 991,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 968,\n      columnNumber: 7\n    }, this), showTagPanel && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tag-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tag-panel-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Drag tags onto the chart\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1017,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"tag-panel-close\",\n          onClick: () => setShowTagPanel(false),\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"16\",\n            height: \"16\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            children: [/*#__PURE__*/_jsxDEV(\"line\", {\n              x1: \"18\",\n              y1: \"6\",\n              x2: \"6\",\n              y2: \"18\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1020,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n              x1: \"6\",\n              y1: \"6\",\n              x2: \"18\",\n              y2: \"18\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1021,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1019,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1018,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1016,\n        columnNumber: 11\n      }, this), dismissedEvents.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"reset-dismissed-btn\",\n        onClick: handleResetDismissed,\n        children: [\"Reset \", dismissedEvents.length, \" dismissed event\", dismissedEvents.length !== 1 ? 's' : '']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1027,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"preset-tags\",\n        children: PRESET_TAGS\n        // Filter out preset tags that match pinned events by name\n        .filter(tag => {\n          const tagNameLower = tag.name.toLowerCase();\n          // Check if this tag name matches any pinned event\n          const isPinnedAlready = (chartTags || []).some(ct => ct.isSpan && ct.name.toLowerCase() === tagNameLower);\n          return !isPinnedAlready;\n        }).map(tag => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"draggable-tag\",\n          draggable: true,\n          onDragStart: e => handleDragStart(e, tag),\n          onDragEnd: handleDragEnd,\n          style: {\n            borderColor: tag.color\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag-marker\",\n            style: {\n              background: tag.color\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1052,\n            columnNumber: 17\n          }, this), tag.name]\n        }, tag.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1044,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1032,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"custom-tag-section\",\n        children: !showCustomForm ? /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"add-custom-tag-btn\",\n          onClick: () => setShowCustomForm(true),\n          children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"14\",\n            height: \"14\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            children: [/*#__PURE__*/_jsxDEV(\"line\", {\n              x1: \"12\",\n              y1: \"5\",\n              x2: \"12\",\n              y2: \"19\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1065,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n              x1: \"5\",\n              y1: \"12\",\n              x2: \"19\",\n              y2: \"12\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1066,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1064,\n            columnNumber: 17\n          }, this), \"Create Custom Tag\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1060,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"custom-tag-form\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Tag name\",\n            value: customTagName,\n            onChange: e => setCustomTagName(e.target.value),\n            className: \"custom-tag-input\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1072,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Your name (owner)\",\n            value: customTagOwner,\n            onChange: e => setCustomTagOwner(e.target.value),\n            className: \"custom-tag-input\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1079,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            placeholder: \"Short description (optional)\",\n            value: customTagDescription,\n            onChange: e => setCustomTagDescription(e.target.value),\n            className: \"custom-tag-textarea\",\n            rows: 2\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1086,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"custom-tag-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"custom-tag-cancel\",\n              onClick: () => {\n                setShowCustomForm(false);\n                setCustomTagName('');\n                setCustomTagOwner('');\n                setCustomTagDescription('');\n              },\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1094,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"custom-tag-create\",\n              onClick: handleAddCustomTag,\n              disabled: !customTagName.trim() || !customTagOwner.trim(),\n              children: \"Create & Drag\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1105,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1093,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1071,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1058,\n        columnNumber: 11\n      }, this), draggedTag && draggedTag.isCustom && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drag-instruction\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Now drag your custom tag \\\"\", draggedTag.name, \"\\\" onto the chart\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1119,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"draggable-tag custom\",\n          draggable: true,\n          onDragStart: e => handleDragStart(e, draggedTag),\n          onDragEnd: handleDragEnd,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag-marker\",\n            style: {\n              background: draggedTag.color\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1126,\n            columnNumber: 17\n          }, this), draggedTag.name, /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tag-owner\",\n            children: [\"by \", draggedTag.owner]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1128,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1120,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1118,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1015,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 942,\n    columnNumber: 5\n  }, this);\n}\n_s(KPIChart, \"JXO3TZ+Dl6W9UG8/abZZqZDrQ6k=\", false, function () {\n  return [useAuth];\n});\n_c = KPIChart;\nexport default KPIChart;\nvar _c;\n$RefreshReg$(_c, \"KPIChart\");","map":{"version":3,"names":["useState","useRef","useCallback","useEffect","LineChart","Line","AreaChart","Area","BarChart","Bar","XAxis","YAxis","CartesianGrid","Tooltip","ResponsiveContainer","ReferenceLine","Legend","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","PRESET_TAGS","id","name","color","CHART_MARGINS","top","right","left","bottom","Y_AXIS_WIDTH","CHART_HEIGHT","PLOT_AREA_HEIGHT","hexToRgba","hex","alpha","r","parseInt","slice","g","b","KPIChart","data","kpi","chartType","format","launchDate","comparisonData","chartTags","onTagsChange","displayMode","events","_s","isBetaMode","isBeta","chartContainerRef","showTagPanel","setShowTagPanel","customTagName","setCustomTagName","customTagOwner","setCustomTagOwner","customTagDescription","setCustomTagDescription","draggedTag","setDraggedTag","showCustomForm","setShowCustomForm","dragPreview","setDragPreview","containerWidth","setContainerWidth","expandedTagId","setExpandedTagId","showSuggestedEvents","setShowSuggestedEvents","dismissedEvents","setDismissedEvents","stored","sessionStorage","getItem","JSON","parse","editingEvent","setEditingEvent","rawChartData","length","hasComparison","chartData","map","d","displayDate","date_ly","date","updateWidth","current","width","offsetWidth","initialTimeout","setTimeout","secondTimeout","window","addEventListener","resizeObserver","ResizeObserver","requestAnimationFrame","observe","clearTimeout","removeEventListener","disconnect","formatValue","val","undefined","isNaN","Math","abs","toFixed","toLocaleString","formatAxisDate","dateStr","Date","toLocaleDateString","month","day","formatFullDate","weekday","year","getContainerRect","getBoundingClientRect","getDateIndexFromX","clientX","rect","chartAreaLeft","chartAreaWidth","relativeX","percentage","max","min","dataIndex","round","getXPositionForIndex","index","_chartContainerRef$cu","CustomTooltip","active","payload","label","dateTag","find","t","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","background","entry","value","handleDragStart","e","tag","dataTransfer","effectAllowed","img","Image","src","setDragImage","handleDragOver","_chartData$dateIndex","preventDefault","dropEffect","dateIndex","targetDate","xPosition","formattedDate","x","handleDragLeave","_chartContainerRef$cu2","clientY","handleDrop","_chartData$dateIndex2","newTag","now","handleDragEnd","handleAddCustomTag","trim","owner","description","isCustom","handleTagClick","tagId","handleRemoveTag","filter","setItem","stringify","handleDismissEvent","eventId","prev","handleResetDismissed","pinnedEventIds","sourceEventId","getFilteredEvents","_chartData$","_chartData","chartStartDate","chartEndDate","chartStart","chartEnd","yearLabel","ev","includes","evStart","startDate","evEnd","endDate","getTime","adjustedStart","adjustedEnd","getIndexForDate","bestIdx","bestDiff","Infinity","i","diff","renderSingleSpan","isPinned","_chartContainerRef$cu3","currentWidth","startIdx","endIdx","clampedStart","clampedEnd","startPct","endPct","leftPx","rightPx","widthPx","centerPx","fillColor","borderColor","borderLeft","borderRight","onClick","stopPropagation","title","tier","isSpan","toISOString","source","getPinnedSpans","_chartData$2","_chartData2","tagStart","tagEnd","renderEventSpans","_chartContainerRef$cu4","pinnedSpans","suggestedEvents","span","commonProps","margin","axisStyle","fontSize","fill","fontWeight","calculateTickInterval","dataPoints","targetTicks","interval","floor","tickInterval","tyDataKey","lyDataKey","showTY","showLY","renderPlacedTags","_chartContainerRef$cu5","pointTags","poleHeight","findIndex","xPos","isExpanded","hasDetails","height","renderDragPreview","renderChart","x1","y1","x2","y2","offset","stopColor","stopOpacity","strokeDasharray","stroke","vertical","dataKey","tick","tickLine","axisLine","tickFormatter","content","strokeWidth","position","type","dot","activeDot","radius","maxBarSize","ref","onDragOver","onDragLeave","onDrop","viewBox","strokeLinecap","strokeLinejoin","tagNameLower","toLowerCase","isPinnedAlready","some","ct","draggable","onDragStart","onDragEnd","placeholder","onChange","target","rows","disabled","_c","$RefreshReg$"],"sources":["C:/Users/AkashPatil/THD-Dashboard/frontend/src/components/KPIChart.js"],"sourcesContent":["import { useState, useRef, useCallback, useEffect } from 'react';\r\nimport {\r\n  LineChart, Line, AreaChart, Area, BarChart, Bar,\r\n  XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer,\r\n  ReferenceLine, Legend\r\n} from 'recharts';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport './KPIChart.css';\r\n\r\n// Preset event tags - these are for manual tagging of events NOT in the Event Tracker\r\n// Events like Black Friday, Labor Day, etc. come from the Event Tracker automatically\r\nconst PRESET_TAGS = [\r\n  { id: 'thanksgiving', name: 'Thanksgiving', color: '#F96302' },\r\n  { id: 'july4th', name: '4th of July', color: '#FF3B30' },\r\n  { id: 'tier1', name: 'Tier 1 Event', color: '#5856D6' },\r\n  { id: 'promo', name: 'Promo', color: '#34C759' },\r\n  { id: 'outage', name: 'Outage/Issue', color: '#FF2D55' }\r\n];\r\n\r\n// Chart margins matching Recharts config\r\nconst CHART_MARGINS = { top: 20, right: 20, left: 10, bottom: 20 };\r\nconst Y_AXIS_WIDTH = 60;\r\nconst CHART_HEIGHT = 320;\r\n// Height of the actual plot area (excluding X-axis labels ~30px and Legend ~24px)\r\nconst PLOT_AREA_HEIGHT = CHART_HEIGHT - CHART_MARGINS.top - CHART_MARGINS.bottom - 54;\r\n\r\n// Convert hex color string to rgba with given alpha\r\nfunction hexToRgba(hex, alpha) {\r\n  const r = parseInt(hex.slice(1, 3), 16);\r\n  const g = parseInt(hex.slice(3, 5), 16);\r\n  const b = parseInt(hex.slice(5, 7), 16);\r\n  return `rgba(${r},${g},${b},${alpha})`;\r\n}\r\n\r\nfunction KPIChart({ data, kpi, chartType, format, launchDate, comparisonData, chartTags, onTagsChange, displayMode = 'both', events = [] }) {\r\n  const { isBetaMode } = useAuth();\r\n  const isBeta = isBetaMode();\r\n  const chartContainerRef = useRef(null);\r\n  const [showTagPanel, setShowTagPanel] = useState(false);\r\n  const [customTagName, setCustomTagName] = useState('');\r\n  const [customTagOwner, setCustomTagOwner] = useState('');\r\n  const [customTagDescription, setCustomTagDescription] = useState('');\r\n  const [draggedTag, setDraggedTag] = useState(null);\r\n  const [showCustomForm, setShowCustomForm] = useState(false);\r\n  const [dragPreview, setDragPreview] = useState(null);\r\n  const [containerWidth, setContainerWidth] = useState(0);\r\n  const [expandedTagId, setExpandedTagId] = useState(null);\r\n  const [showSuggestedEvents, setShowSuggestedEvents] = useState(false);\r\n  const [dismissedEvents, setDismissedEvents] = useState(() => {\r\n    try {\r\n      const stored = sessionStorage.getItem('dismissedEvents');\r\n      return stored ? JSON.parse(stored) : [];\r\n    } catch { return []; }\r\n  });\r\n  const [editingEvent, setEditingEvent] = useState(null);\r\n\r\n  // Use comparison data if available, otherwise fall back to regular data\r\n  const rawChartData = comparisonData && comparisonData.length > 0 ? comparisonData : data;\r\n  const hasComparison = comparisonData && comparisonData.length > 0;\r\n\r\n  // Add displayDate field based on displayMode\r\n  // When showing LY only, use date_ly for X-axis; otherwise use date (TY)\r\n  const chartData = rawChartData?.map(d => ({\r\n    ...d,\r\n    displayDate: displayMode === 'ly' && d.date_ly ? d.date_ly : d.date\r\n  })) || [];\r\n\r\n  // Track container width for tag positioning\r\n  useEffect(() => {\r\n    const updateWidth = () => {\r\n      if (chartContainerRef.current) {\r\n        const width = chartContainerRef.current.offsetWidth;\r\n        if (width > 0) {\r\n          setContainerWidth(width);\r\n        }\r\n      }\r\n    };\r\n\r\n    // Initial update with a slight delay to ensure DOM is ready\r\n    updateWidth();\r\n    const initialTimeout = setTimeout(updateWidth, 100);\r\n    const secondTimeout = setTimeout(updateWidth, 300);\r\n\r\n    window.addEventListener('resize', updateWidth);\r\n\r\n    // Also observe size changes\r\n    const resizeObserver = new ResizeObserver(() => {\r\n      // Use requestAnimationFrame to avoid layout thrashing\r\n      requestAnimationFrame(() => {\r\n        updateWidth();\r\n      });\r\n    });\r\n    if (chartContainerRef.current) {\r\n      resizeObserver.observe(chartContainerRef.current);\r\n    }\r\n\r\n    return () => {\r\n      clearTimeout(initialTimeout);\r\n      clearTimeout(secondTimeout);\r\n      window.removeEventListener('resize', updateWidth);\r\n      resizeObserver.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  // Force width recalculation when chartTags change (ensures tags render properly)\r\n  useEffect(() => {\r\n    if (chartTags && chartTags.length > 0 && chartContainerRef.current) {\r\n      const width = chartContainerRef.current.offsetWidth;\r\n      if (width > 0 && containerWidth !== width) {\r\n        setContainerWidth(width);\r\n      }\r\n    }\r\n  }, [chartTags, containerWidth]);\r\n\r\n  const formatValue = (val) => {\r\n    if (val === null || val === undefined || isNaN(val)) return '-';\r\n\r\n    if (format === 'currency') {\r\n      if (Math.abs(val) >= 1000000) {\r\n        return `$${(val / 1000000).toFixed(1)}M`;\r\n      }\r\n      if (Math.abs(val) >= 1000) {\r\n        return `$${(val / 1000).toFixed(0)}K`;\r\n      }\r\n      return `$${val.toFixed(2)}`;\r\n    }\r\n    if (format === 'percentage') {\r\n      return `${(val * 100).toFixed(2)}%`;\r\n    }\r\n    if (Math.abs(val) >= 1000000) {\r\n      return `${(val / 1000000).toFixed(1)}M`;\r\n    }\r\n    if (Math.abs(val) >= 1000) {\r\n      return `${(val / 1000).toFixed(0)}K`;\r\n    }\r\n    return val.toLocaleString();\r\n  };\r\n\r\n  const formatAxisDate = (dateStr) => {\r\n    const date = new Date(dateStr);\r\n    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });\r\n  };\r\n\r\n  const formatFullDate = (dateStr) => {\r\n    const date = new Date(dateStr);\r\n    return date.toLocaleDateString('en-US', {\r\n      weekday: 'short',\r\n      month: 'short',\r\n      day: 'numeric',\r\n      year: 'numeric'\r\n    });\r\n  };\r\n\r\n  // Get container rect - always fresh to handle dynamic sizing\r\n  const getContainerRect = useCallback(() => {\r\n    if (!chartContainerRef.current) return null;\r\n    return chartContainerRef.current.getBoundingClientRect();\r\n  }, []);\r\n\r\n  // Calculate date index from clientX position\r\n  const getDateIndexFromX = useCallback((clientX) => {\r\n    if (!chartData || chartData.length === 0) return -1;\r\n    const rect = getContainerRect();\r\n    if (!rect) return -1;\r\n\r\n    const chartAreaLeft = Y_AXIS_WIDTH + CHART_MARGINS.left;\r\n    const chartAreaWidth = rect.width - chartAreaLeft - CHART_MARGINS.right;\r\n\r\n    const relativeX = clientX - rect.left - chartAreaLeft;\r\n    const percentage = Math.max(0, Math.min(1, relativeX / chartAreaWidth));\r\n\r\n    const dataIndex = Math.round(percentage * (chartData.length - 1));\r\n    return Math.max(0, Math.min(dataIndex, chartData.length - 1));\r\n  }, [chartData, getContainerRect]);\r\n\r\n  // Get x position (relative to container) for a data index\r\n  const getXPositionForIndex = useCallback((index) => {\r\n    if (!chartData || chartData.length === 0 || index < 0) return 0;\r\n\r\n    // Use containerWidth state for reliable positioning\r\n    const width = containerWidth || (chartContainerRef.current?.offsetWidth || 0);\r\n    if (width === 0) return 0;\r\n\r\n    const chartAreaLeft = Y_AXIS_WIDTH + CHART_MARGINS.left;\r\n    const chartAreaWidth = width - chartAreaLeft - CHART_MARGINS.right;\r\n\r\n    // Handle single data point\r\n    if (chartData.length === 1) {\r\n      return chartAreaLeft + chartAreaWidth / 2;\r\n    }\r\n\r\n    const percentage = index / (chartData.length - 1);\r\n    return chartAreaLeft + (percentage * chartAreaWidth);\r\n  }, [chartData, containerWidth]);\r\n\r\n  const CustomTooltip = ({ active, payload, label }) => {\r\n    if (active && payload && payload.length) {\r\n      const dateStr = new Date(label).toLocaleDateString('en-US', {\r\n        weekday: 'short',\r\n        month: 'short',\r\n        day: 'numeric',\r\n        year: 'numeric'\r\n      });\r\n\r\n      // Check if there's a tag for this date\r\n      const dateTag = chartTags?.find(t => t.date === label);\r\n\r\n      return (\r\n        <div className=\"chart-tooltip\">\r\n          <p className=\"tooltip-date\">{dateStr}</p>\r\n          {dateTag && (\r\n            <p className=\"tooltip-tag\">\r\n              <span className=\"tooltip-tag-marker\" style={{ background: dateTag.color }}></span>\r\n              {dateTag.name}\r\n            </p>\r\n          )}\r\n          {payload.map((entry, index) => (\r\n            <p key={index} className=\"tooltip-value\" style={{ color: entry.color }}>\r\n              <span className=\"tooltip-label\">{entry.name}: </span>\r\n              {formatValue(entry.value)}\r\n            </p>\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const handleDragStart = (e, tag) => {\r\n    setDraggedTag(tag);\r\n    e.dataTransfer.effectAllowed = 'copy';\r\n    // Set a transparent drag image\r\n    const img = new Image();\r\n    img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\r\n    e.dataTransfer.setDragImage(img, 0, 0);\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = 'copy';\r\n\r\n    if (!draggedTag || !chartData || chartData.length === 0) return;\r\n\r\n    const rect = getContainerRect();\r\n    if (!rect) return;\r\n\r\n    const dateIndex = getDateIndexFromX(e.clientX);\r\n    const targetDate = chartData[dateIndex]?.date;\r\n\r\n    // Calculate position relative to container for display\r\n    const xPosition = getXPositionForIndex(dateIndex);\r\n\r\n    if (targetDate && dateIndex >= 0) {\r\n      setDragPreview({\r\n        date: targetDate,\r\n        formattedDate: formatFullDate(targetDate),\r\n        x: xPosition,\r\n        index: dateIndex,\r\n        tag: draggedTag\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    // Only clear preview if we're actually leaving the chart area\r\n    const rect = chartContainerRef.current?.getBoundingClientRect();\r\n    if (rect) {\r\n      const { clientX, clientY } = e;\r\n      if (clientX < rect.left || clientX > rect.right ||\r\n          clientY < rect.top || clientY > rect.bottom) {\r\n        setDragPreview(null);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    if (!draggedTag || !chartData || chartData.length === 0) return;\r\n\r\n    const dateIndex = getDateIndexFromX(e.clientX);\r\n    const targetDate = chartData[dateIndex]?.date;\r\n\r\n    if (targetDate) {\r\n      const newTag = {\r\n        ...draggedTag,\r\n        id: `${draggedTag.id}-${Date.now()}`,\r\n        date: targetDate,\r\n        dateIndex: dateIndex\r\n      };\r\n\r\n      if (onTagsChange) {\r\n        onTagsChange([...(chartTags || []), newTag]);\r\n      }\r\n    }\r\n\r\n    setDraggedTag(null);\r\n    setDragPreview(null);\r\n  };\r\n\r\n  const handleDragEnd = () => {\r\n    setDragPreview(null);\r\n  };\r\n\r\n  const handleAddCustomTag = () => {\r\n    if (!customTagName.trim() || !customTagOwner.trim()) return;\r\n\r\n    const newTag = {\r\n      id: `custom-${Date.now()}`,\r\n      name: customTagName.trim(),\r\n      owner: customTagOwner.trim(),\r\n      description: customTagDescription.trim() || '',\r\n      color: '#6e6e73',\r\n      isCustom: true\r\n    };\r\n\r\n    setDraggedTag(newTag);\r\n    setCustomTagName('');\r\n    setCustomTagOwner('');\r\n    setCustomTagDescription('');\r\n    setShowCustomForm(false);\r\n  };\r\n\r\n  const handleTagClick = (tagId) => {\r\n    setExpandedTagId(expandedTagId === tagId ? null : tagId);\r\n  };\r\n\r\n  const handleRemoveTag = (tagId) => {\r\n    if (onTagsChange) {\r\n      onTagsChange((chartTags || []).filter(t => t.id !== tagId));\r\n    }\r\n  };\r\n\r\n  // Persist dismissedEvents to sessionStorage whenever they change\r\n  useEffect(() => {\r\n    try {\r\n      sessionStorage.setItem('dismissedEvents', JSON.stringify(dismissedEvents));\r\n    } catch { /* ignore */ }\r\n  }, [dismissedEvents]);\r\n\r\n  // Dismiss a suggested event (session-scoped)\r\n  const handleDismissEvent = (eventId) => {\r\n    setDismissedEvents(prev => [...prev, eventId]);\r\n  };\r\n\r\n  // Reset all dismissed events\r\n  const handleResetDismissed = () => {\r\n    setDismissedEvents([]);\r\n  };\r\n\r\n  // Get list of pinned event IDs from chartTags\r\n  const pinnedEventIds = (chartTags || [])\r\n    .filter(tag => tag.sourceEventId)\r\n    .map(tag => tag.sourceEventId);\r\n\r\n  // Year-aware event filtering: returns events adjusted to the visible chart date range\r\n  // Excludes dismissed and pinned events\r\n  const getFilteredEvents = useCallback(() => {\r\n    if (!events || events.length === 0 || !chartData || chartData.length === 0) return [];\r\n\r\n    const chartStartDate = chartData[0]?.date;\r\n    const chartEndDate = chartData[chartData.length - 1]?.date;\r\n    if (!chartStartDate || !chartEndDate) return [];\r\n\r\n    const chartStart = new Date(chartStartDate + 'T00:00:00');\r\n    const chartEnd = new Date(chartEndDate + 'T00:00:00');\r\n\r\n    // Determine year label suffix based on displayMode\r\n    const yearLabel = displayMode === 'ly' ? 'LY' : 'TY';\r\n\r\n    return events\r\n      .filter(ev => !dismissedEvents.includes(ev.id))\r\n      .filter(ev => !pinnedEventIds.includes(ev.id)) // Exclude pinned events\r\n      .map(ev => {\r\n        let evStart = new Date(ev.startDate + 'T00:00:00');\r\n        let evEnd = new Date(ev.endDate + 'T00:00:00');\r\n\r\n        // When showing LY only, shift event dates back 365 days\r\n        if (displayMode === 'ly') {\r\n          evStart = new Date(evStart.getTime() - 365 * 24 * 60 * 60 * 1000);\r\n          evEnd = new Date(evEnd.getTime() - 365 * 24 * 60 * 60 * 1000);\r\n        }\r\n\r\n        return { ...ev, adjustedStart: evStart, adjustedEnd: evEnd, yearLabel };\r\n      })\r\n      .filter(ev => {\r\n        // Keep only events that overlap with the visible chart range\r\n        return ev.adjustedStart <= chartEnd && ev.adjustedEnd >= chartStart;\r\n      });\r\n  }, [events, chartData, displayMode, dismissedEvents, pinnedEventIds]);\r\n\r\n  // Convert a date to the nearest data index in chartData\r\n  const getIndexForDate = useCallback((targetDate) => {\r\n    if (!chartData || chartData.length === 0) return -1;\r\n    let bestIdx = 0;\r\n    let bestDiff = Infinity;\r\n    for (let i = 0; i < chartData.length; i++) {\r\n      const d = new Date(chartData[i].date + 'T00:00:00');\r\n      const diff = Math.abs(d.getTime() - targetDate.getTime());\r\n      if (diff < bestDiff) {\r\n        bestDiff = diff;\r\n        bestIdx = i;\r\n      }\r\n    }\r\n    return bestIdx;\r\n  }, [chartData]);\r\n\r\n  // Helper to render a single event span (used for both suggestions and pinned)\r\n  const renderSingleSpan = (ev, isPinned = false) => {\r\n    const currentWidth = containerWidth || (chartContainerRef.current?.offsetWidth || 0);\r\n    if (currentWidth === 0) return null;\r\n\r\n    const chartAreaLeft = Y_AXIS_WIDTH + CHART_MARGINS.left;\r\n    const chartAreaWidth = currentWidth - chartAreaLeft - CHART_MARGINS.right;\r\n\r\n    // For pinned spans, adjustedStart/End are stored as ISO strings\r\n    const evStart = isPinned ? new Date(ev.adjustedStart) : ev.adjustedStart;\r\n    const evEnd = isPinned ? new Date(ev.adjustedEnd) : ev.adjustedEnd;\r\n\r\n    const startIdx = getIndexForDate(evStart);\r\n    const endIdx = getIndexForDate(evEnd);\r\n\r\n    // Clamp indices to chart bounds\r\n    const clampedStart = Math.max(0, startIdx);\r\n    const clampedEnd = Math.min(chartData.length - 1, endIdx);\r\n\r\n    // Calculate pixel positions\r\n    const startPct = chartData.length === 1 ? 0.5 : clampedStart / (chartData.length - 1);\r\n    const endPct = chartData.length === 1 ? 0.5 : clampedEnd / (chartData.length - 1);\r\n\r\n    const leftPx = chartAreaLeft + startPct * chartAreaWidth;\r\n    const rightPx = chartAreaLeft + endPct * chartAreaWidth;\r\n    const widthPx = Math.max(rightPx - leftPx, 4); // minimum 4px width\r\n\r\n    const centerPx = leftPx + widthPx / 2;\r\n\r\n    // Solid fill with edge borders - cleaner than gradient\r\n    const fillColor = hexToRgba(ev.color, 0.12);\r\n    const borderColor = hexToRgba(ev.color, 0.5);\r\n\r\n    return (\r\n      <div\r\n        key={ev.id}\r\n        className={`event-span ${isPinned ? 'pinned' : ''}`}\r\n        style={{\r\n          left: `${leftPx}px`,\r\n          width: `${widthPx}px`,\r\n          background: fillColor,\r\n          borderLeft: `2px solid ${borderColor}`,\r\n          borderRight: `2px solid ${borderColor}`,\r\n        }}\r\n      >\r\n        {/* Pill label at center */}\r\n        <div\r\n          className=\"event-span-label\"\r\n          style={{ left: `${centerPx - leftPx}px`, background: ev.color }}\r\n          onClick={() => !isPinned && setEditingEvent(editingEvent?.id === ev.id ? null : ev)}\r\n        >\r\n          <span className=\"event-span-label-text\">\r\n            {ev.name || ev.label} ({ev.yearLabel})\r\n          </span>\r\n          {isPinned ? (\r\n            <button\r\n              className=\"event-span-dismiss\"\r\n              onClick={(e) => { e.stopPropagation(); handleRemoveTag(ev.id); }}\r\n              title=\"Remove\"\r\n            >\r\n              x\r\n            </button>\r\n          ) : (\r\n            <button\r\n              className=\"event-span-dismiss\"\r\n              onClick={(e) => { e.stopPropagation(); handleDismissEvent(ev.id); }}\r\n              title=\"Dismiss\"\r\n            >\r\n              x\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Edit popover - only for suggestions, not pinned */}\r\n        {!isPinned && editingEvent?.id === ev.id && (\r\n          <div className=\"event-span-edit\" style={{ left: `${centerPx - leftPx}px` }}>\r\n            <div className=\"event-span-edit-header\">\r\n              <strong>{ev.label}</strong>\r\n              <button className=\"event-span-edit-close\" onClick={() => setEditingEvent(null)}>x</button>\r\n            </div>\r\n            <p className=\"event-span-edit-dates\">\r\n              {new Date(ev.adjustedStart).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\r\n              {' - '}\r\n              {new Date(ev.adjustedEnd).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\r\n            </p>\r\n            <p className=\"event-span-edit-tier\">\r\n              {ev.tier ? 'Tier 1 Event' : 'Tracked Event'}\r\n            </p>\r\n            <button\r\n              className=\"event-span-pin-btn\"\r\n              onClick={() => {\r\n                // Pin as a permanent span (not point marker) with full event data\r\n                if (onTagsChange) {\r\n                  onTagsChange([...(chartTags || []), {\r\n                    id: `pinned-${ev.id}-${Date.now()}`,\r\n                    name: ev.label,\r\n                    color: ev.color,\r\n                    // Store the original event ID to track which event was pinned\r\n                    sourceEventId: ev.id,\r\n                    // Store span data for rendering as a span\r\n                    isSpan: true,\r\n                    startDate: ev.startDate,\r\n                    endDate: ev.endDate,\r\n                    adjustedStart: ev.adjustedStart.toISOString(),\r\n                    adjustedEnd: ev.adjustedEnd.toISOString(),\r\n                    yearLabel: ev.yearLabel,\r\n                    tier: ev.tier,\r\n                    source: 'suggested'\r\n                  }]);\r\n                }\r\n                setEditingEvent(null);\r\n              }}\r\n            >\r\n              Pin to chart\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Get pinned span tags that overlap with current chart range\r\n  const getPinnedSpans = useCallback(() => {\r\n    if (!chartTags || !chartData || chartData.length === 0) return [];\r\n\r\n    const chartStartDate = chartData[0]?.date;\r\n    const chartEndDate = chartData[chartData.length - 1]?.date;\r\n    if (!chartStartDate || !chartEndDate) return [];\r\n\r\n    const chartStart = new Date(chartStartDate + 'T00:00:00');\r\n    const chartEnd = new Date(chartEndDate + 'T00:00:00');\r\n\r\n    return chartTags\r\n      .filter(tag => tag.isSpan)\r\n      .filter(tag => {\r\n        const tagStart = new Date(tag.adjustedStart);\r\n        const tagEnd = new Date(tag.adjustedEnd);\r\n        return tagStart <= chartEnd && tagEnd >= chartStart;\r\n      });\r\n  }, [chartTags, chartData]);\r\n\r\n  // Render gradient event spans behind the chart (both suggestions and pinned)\r\n  const renderEventSpans = () => {\r\n    const currentWidth = containerWidth || (chartContainerRef.current?.offsetWidth || 0);\r\n    if (currentWidth === 0) return null;\r\n\r\n    // Get pinned spans (always show)\r\n    const pinnedSpans = getPinnedSpans();\r\n\r\n    // Get suggested events (only when toggle is on)\r\n    const suggestedEvents = showSuggestedEvents ? getFilteredEvents() : [];\r\n\r\n    // If nothing to render, return null\r\n    if (pinnedSpans.length === 0 && suggestedEvents.length === 0) return null;\r\n\r\n    return (\r\n      <>\r\n        {/* Render pinned spans first (always visible) */}\r\n        {pinnedSpans.map(span => renderSingleSpan(span, true))}\r\n        {/* Render suggested events (when toggle is on) */}\r\n        {suggestedEvents.map(ev => renderSingleSpan(ev, false))}\r\n      </>\r\n    );\r\n  };\r\n\r\n  const commonProps = {\r\n    data: chartData,\r\n    margin: CHART_MARGINS\r\n  };\r\n\r\n  const axisStyle = {\r\n    fontSize: 11,\r\n    fill: '#86868b',\r\n    fontWeight: 500\r\n  };\r\n\r\n  // Calculate tick interval for evenly spaced X-axis labels\r\n  // Target ~6-8 ticks for readability, ensuring even spacing\r\n  const calculateTickInterval = () => {\r\n    if (!chartData || chartData.length <= 1) return 0;\r\n    const dataPoints = chartData.length;\r\n    const targetTicks = 7; // Aim for 7 evenly spaced ticks\r\n    const interval = Math.max(0, Math.floor((dataPoints - 1) / (targetTicks - 1)) - 1);\r\n    return interval;\r\n  };\r\n\r\n  const tickInterval = calculateTickInterval();\r\n\r\n  // Get the correct data keys based on comparison mode\r\n  const tyDataKey = hasComparison ? `${kpi}_ty` : kpi;\r\n  const lyDataKey = hasComparison ? `${kpi}_ly` : null;\r\n\r\n  // Determine which lines to show based on displayMode\r\n  const showTY = displayMode === 'both' || displayMode === 'ty';\r\n  const showLY = displayMode === 'both' || displayMode === 'ly';\r\n\r\n  // Render placed tags as overlay elements (point tags only, not span tags)\r\n  const renderPlacedTags = () => {\r\n    if (!chartTags || chartTags.length === 0 || !chartData || chartData.length === 0) return null;\r\n\r\n    // Filter out span tags - they're rendered in renderEventSpans\r\n    const pointTags = chartTags.filter(t => !t.isSpan);\r\n    if (pointTags.length === 0) return null;\r\n\r\n    // Get current width - fallback to ref if state is 0\r\n    const currentWidth = containerWidth || (chartContainerRef.current?.offsetWidth || 0);\r\n    if (currentWidth === 0) return null;\r\n\r\n    // Pole extends from tag area into chart\r\n    const poleHeight = CHART_HEIGHT - CHART_MARGINS.bottom - 40;\r\n\r\n    return pointTags.map((tag) => {\r\n      // Find the date index - use stored index first, then lookup by date\r\n      let dateIndex = tag.dateIndex;\r\n      if (dateIndex === undefined || dateIndex < 0 || dateIndex >= chartData.length) {\r\n        dateIndex = chartData.findIndex(d => d.date === tag.date);\r\n      }\r\n\r\n      if (dateIndex === -1 || dateIndex >= chartData.length) return null;\r\n\r\n      const xPos = getXPositionForIndex(dateIndex);\r\n      if (xPos === 0 && dateIndex !== 0) return null; // Position calculation failed\r\n\r\n      const isExpanded = expandedTagId === tag.id;\r\n      const hasDetails = tag.owner || tag.description;\r\n\r\n      return (\r\n        <div\r\n          key={tag.id}\r\n          className={`placed-tag-container ${isExpanded ? 'expanded' : ''}`}\r\n          style={{ left: `${xPos}px` }}\r\n        >\r\n          {/* Tag label - compact pill design, clickable if has details */}\r\n          <div\r\n            className={`tag-label ${hasDetails ? 'clickable' : ''}`}\r\n            style={{ background: tag.color }}\r\n            onClick={hasDetails ? () => handleTagClick(tag.id) : undefined}\r\n          >\r\n            <span className=\"tag-label-text\">{tag.name}</span>\r\n            {hasDetails && (\r\n              <span className=\"tag-expand-icon\">\r\n                {isExpanded ? 'âˆ’' : '+'}\r\n              </span>\r\n            )}\r\n            <button\r\n              className=\"tag-label-remove\"\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                handleRemoveTag(tag.id);\r\n              }}\r\n              title=\"Remove tag\"\r\n            >\r\n              Ã—\r\n            </button>\r\n          </div>\r\n\r\n          {/* Expanded details panel */}\r\n          {isExpanded && hasDetails && (\r\n            <div className=\"tag-details\" style={{ borderColor: tag.color }}>\r\n              {tag.description && (\r\n                <p className=\"tag-description\">{tag.description}</p>\r\n              )}\r\n              {tag.owner && (\r\n                <p className=\"tag-owner-info\">\r\n                  <span className=\"tag-owner-label\">Owner:</span> {tag.owner}\r\n                </p>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Vertical pole extending down */}\r\n          <div\r\n            className=\"tag-pole\"\r\n            style={{\r\n              background: tag.color,\r\n              height: poleHeight\r\n            }}\r\n          ></div>\r\n          {/* Date at bottom */}\r\n          <div className=\"tag-date\" style={{ color: tag.color }}>\r\n            {formatAxisDate(tag.date)}\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  // Render drag preview\r\n  const renderDragPreview = () => {\r\n    if (!dragPreview || dragPreview.x === 0) return null;\r\n\r\n    const poleHeight = CHART_HEIGHT - CHART_MARGINS.bottom - 40;\r\n\r\n    return (\r\n      <div\r\n        className=\"drag-preview-container\"\r\n        style={{ left: `${dragPreview.x}px` }}\r\n      >\r\n        {/* Preview tag label */}\r\n        <div className=\"tag-label preview\" style={{ background: dragPreview.tag.color }}>\r\n          <span className=\"tag-label-text\">{dragPreview.tag.name}</span>\r\n        </div>\r\n        {/* Preview pole - dashed */}\r\n        <div\r\n          className=\"tag-pole preview\"\r\n          style={{\r\n            borderColor: dragPreview.tag.color,\r\n            height: poleHeight\r\n          }}\r\n        ></div>\r\n        {/* Date display */}\r\n        <div className=\"tag-date preview\" style={{ color: dragPreview.tag.color }}>\r\n          {dragPreview.formattedDate}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderChart = () => {\r\n    switch (chartType) {\r\n      case 'area':\r\n        return (\r\n          <AreaChart {...commonProps}>\r\n            <defs>\r\n              <linearGradient id=\"areaGradientTY\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                <stop offset=\"0%\" stopColor=\"#F96302\" stopOpacity={0.25}/>\r\n                <stop offset=\"100%\" stopColor=\"#F96302\" stopOpacity={0}/>\r\n              </linearGradient>\r\n              <linearGradient id=\"areaGradientLY\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                <stop offset=\"0%\" stopColor=\"#86868b\" stopOpacity={0.15}/>\r\n                <stop offset=\"100%\" stopColor=\"#86868b\" stopOpacity={0}/>\r\n              </linearGradient>\r\n            </defs>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,0,0,0.04)\" vertical={false} />\r\n            <XAxis\r\n              dataKey=\"date\"\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={{ stroke: 'rgba(0,0,0,0.08)' }}\r\n              tickFormatter={formatAxisDate}\r\n              interval={tickInterval}\r\n            />\r\n            <YAxis\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={false}\r\n              tickFormatter={formatValue}\r\n              width={Y_AXIS_WIDTH}\r\n            />\r\n            <Tooltip content={<CustomTooltip />} />\r\n            {hasComparison && <Legend />}\r\n            {launchDate && (\r\n              <ReferenceLine\r\n                x={launchDate}\r\n                stroke=\"#F96302\"\r\n                strokeDasharray=\"4 4\"\r\n                strokeWidth={2}\r\n                label={{\r\n                  value: 'Launch',\r\n                  position: 'top',\r\n                  fill: '#F96302',\r\n                  fontSize: 11,\r\n                  fontWeight: 600\r\n                }}\r\n              />\r\n            )}\r\n            {hasComparison && lyDataKey && showLY && (\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey={lyDataKey}\r\n                name=\"Last Year\"\r\n                stroke=\"#86868b\"\r\n                strokeWidth={1.5}\r\n                strokeDasharray=\"4 4\"\r\n                fill=\"url(#areaGradientLY)\"\r\n                dot={false}\r\n                activeDot={{ r: 4, fill: '#86868b', stroke: '#fff', strokeWidth: 2 }}\r\n              />\r\n            )}\r\n            {showTY && (\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey={tyDataKey}\r\n                name={hasComparison ? \"This Year\" : kpi}\r\n                stroke=\"#F96302\"\r\n                strokeWidth={2}\r\n                fill=\"url(#areaGradientTY)\"\r\n                dot={false}\r\n                activeDot={{ r: 5, fill: '#F96302', stroke: '#fff', strokeWidth: 2 }}\r\n              />\r\n            )}\r\n          </AreaChart>\r\n        );\r\n\r\n      case 'bar':\r\n        return (\r\n          <BarChart {...commonProps}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,0,0,0.04)\" vertical={false} />\r\n            <XAxis\r\n              dataKey=\"date\"\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={{ stroke: 'rgba(0,0,0,0.08)' }}\r\n              tickFormatter={formatAxisDate}\r\n              interval={tickInterval}\r\n            />\r\n            <YAxis\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={false}\r\n              tickFormatter={formatValue}\r\n              width={Y_AXIS_WIDTH}\r\n            />\r\n            <Tooltip content={<CustomTooltip />} />\r\n            {hasComparison && <Legend />}\r\n            {launchDate && (\r\n              <ReferenceLine\r\n                x={launchDate}\r\n                stroke=\"#F96302\"\r\n                strokeDasharray=\"4 4\"\r\n                strokeWidth={2}\r\n              />\r\n            )}\r\n            {hasComparison && lyDataKey && showLY && (\r\n              <Bar\r\n                dataKey={lyDataKey}\r\n                name=\"Last Year\"\r\n                fill=\"#d1d1d6\"\r\n                radius={[4, 4, 0, 0]}\r\n                maxBarSize={20}\r\n              />\r\n            )}\r\n            {showTY && (\r\n              <Bar\r\n                dataKey={tyDataKey}\r\n                name={hasComparison ? \"This Year\" : kpi}\r\n                fill=\"#F96302\"\r\n                radius={[4, 4, 0, 0]}\r\n                maxBarSize={hasComparison ? 20 : 40}\r\n              />\r\n            )}\r\n          </BarChart>\r\n        );\r\n\r\n      default:\r\n        return (\r\n          <LineChart {...commonProps}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,0,0,0.04)\" vertical={false} />\r\n            <XAxis\r\n              dataKey=\"date\"\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={{ stroke: 'rgba(0,0,0,0.08)' }}\r\n              tickFormatter={formatAxisDate}\r\n              interval={tickInterval}\r\n            />\r\n            <YAxis\r\n              tick={axisStyle}\r\n              tickLine={false}\r\n              axisLine={false}\r\n              tickFormatter={formatValue}\r\n              width={Y_AXIS_WIDTH}\r\n            />\r\n            <Tooltip content={<CustomTooltip />} />\r\n            {hasComparison && <Legend />}\r\n            {launchDate && (\r\n              <ReferenceLine\r\n                x={launchDate}\r\n                stroke=\"#F96302\"\r\n                strokeDasharray=\"4 4\"\r\n                strokeWidth={2}\r\n                label={{\r\n                  value: 'Launch',\r\n                  position: 'top',\r\n                  fill: '#F96302',\r\n                  fontSize: 11,\r\n                  fontWeight: 600\r\n                }}\r\n              />\r\n            )}\r\n            {hasComparison && lyDataKey && showLY && (\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey={lyDataKey}\r\n                name=\"Last Year\"\r\n                stroke=\"#86868b\"\r\n                strokeWidth={1.5}\r\n                strokeDasharray=\"4 4\"\r\n                dot={false}\r\n                activeDot={{ r: 4, fill: '#86868b', stroke: '#fff', strokeWidth: 2 }}\r\n              />\r\n            )}\r\n            {showTY && (\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey={tyDataKey}\r\n                name={hasComparison ? \"This Year\" : kpi}\r\n                stroke=\"#F96302\"\r\n                strokeWidth={2}\r\n                dot={false}\r\n                activeDot={{ r: 5, fill: '#F96302', stroke: '#fff', strokeWidth: 2 }}\r\n              />\r\n            )}\r\n          </LineChart>\r\n        );\r\n    }\r\n  };\r\n\r\n  if (!chartData || chartData.length === 0) {\r\n    return (\r\n      <div className=\"chart-empty\">\r\n        <p>No data available for the selected period</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isBeta) {\r\n    return (\r\n      <div className=\"kpi-chart beta-restricted\">\r\n        <div className=\"chart-blur-wrapper\">\r\n          <ResponsiveContainer width=\"100%\" height={320}>\r\n            {renderChart()}\r\n          </ResponsiveContainer>\r\n        </div>\r\n        <div className=\"beta-overlay\">\r\n          <div className=\"beta-overlay-content\">\r\n            <h3>Place holder</h3>\r\n            <p>Chart visualization</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"kpi-chart-wrapper\">\r\n      <div\r\n        className={`kpi-chart ${draggedTag ? 'drop-active' : ''}`}\r\n        ref={chartContainerRef}\r\n        onDragOver={handleDragOver}\r\n        onDragLeave={handleDragLeave}\r\n        onDrop={handleDrop}\r\n      >\r\n        {/* Tag area - space above chart for tag labels */}\r\n        <div className=\"tag-area\">\r\n          {renderPlacedTags()}\r\n          {dragPreview && renderDragPreview()}\r\n        </div>\r\n\r\n        {/* Suggested event spans - rendered behind the chart */}\r\n        <div className=\"event-spans-layer\" style={{ height: `${PLOT_AREA_HEIGHT}px` }}>\r\n          {renderEventSpans()}\r\n        </div>\r\n\r\n        {/* Chart */}\r\n        <ResponsiveContainer width=\"100%\" height={320}>\r\n          {renderChart()}\r\n        </ResponsiveContainer>\r\n      </div>\r\n\r\n      {/* Tag Panel Toggle */}\r\n      <div className=\"chart-tag-controls\">\r\n        <button\r\n          className={`tag-panel-toggle ${showTagPanel ? 'active' : ''}`}\r\n          onClick={() => setShowTagPanel(!showTagPanel)}\r\n        >\r\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n            <path d=\"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z\"></path>\r\n            <line x1=\"7\" y1=\"7\" x2=\"7.01\" y2=\"7\"></line>\r\n          </svg>\r\n          <span>Add Info Tag</span>\r\n        </button>\r\n\r\n        {/* Suggested Events Toggle */}\r\n        <button\r\n          className={`suggested-events-toggle ${showSuggestedEvents ? 'active' : ''}`}\r\n          onClick={() => setShowSuggestedEvents(!showSuggestedEvents)}\r\n        >\r\n          <span className={`suggested-events-dot ${showSuggestedEvents ? 'on' : 'off'}`}></span>\r\n          <span>Suggested Events</span>\r\n        </button>\r\n\r\n        {/* Active Tags Display - only show point tags, not span tags */}\r\n        {chartTags && chartTags.filter(t => !t.isSpan).length > 0 && (\r\n          <div className=\"active-tags\">\r\n            {chartTags.filter(t => !t.isSpan).map(tag => (\r\n              <span\r\n                key={tag.id}\r\n                className=\"active-tag\"\r\n                style={{ borderColor: tag.color, color: tag.color }}\r\n              >\r\n                <span className=\"tag-marker\" style={{ background: tag.color }}></span>\r\n                {tag.name}\r\n                <span className=\"tag-date\">{formatAxisDate(tag.date)}</span>\r\n                <button onClick={() => handleRemoveTag(tag.id)} className=\"tag-remove\">\r\n                  <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\r\n                    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\r\n                  </svg>\r\n                </button>\r\n              </span>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Tag Panel */}\r\n      {showTagPanel && (\r\n        <div className=\"tag-panel\">\r\n          <div className=\"tag-panel-header\">\r\n            <h4>Drag tags onto the chart</h4>\r\n            <button className=\"tag-panel-close\" onClick={() => setShowTagPanel(false)}>\r\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\r\n                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n\r\n          {dismissedEvents.length > 0 && (\r\n            <button className=\"reset-dismissed-btn\" onClick={handleResetDismissed}>\r\n              Reset {dismissedEvents.length} dismissed event{dismissedEvents.length !== 1 ? 's' : ''}\r\n            </button>\r\n          )}\r\n\r\n          <div className=\"preset-tags\">\r\n            {PRESET_TAGS\r\n              // Filter out preset tags that match pinned events by name\r\n              .filter(tag => {\r\n                const tagNameLower = tag.name.toLowerCase();\r\n                // Check if this tag name matches any pinned event\r\n                const isPinnedAlready = (chartTags || []).some(ct =>\r\n                  ct.isSpan && ct.name.toLowerCase() === tagNameLower\r\n                );\r\n                return !isPinnedAlready;\r\n              })\r\n              .map(tag => (\r\n              <div\r\n                key={tag.id}\r\n                className=\"draggable-tag\"\r\n                draggable\r\n                onDragStart={(e) => handleDragStart(e, tag)}\r\n                onDragEnd={handleDragEnd}\r\n                style={{ borderColor: tag.color }}\r\n              >\r\n                <span className=\"tag-marker\" style={{ background: tag.color }}></span>\r\n                {tag.name}\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"custom-tag-section\">\r\n            {!showCustomForm ? (\r\n              <button\r\n                className=\"add-custom-tag-btn\"\r\n                onClick={() => setShowCustomForm(true)}\r\n              >\r\n                <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line>\r\n                  <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line>\r\n                </svg>\r\n                Create Custom Tag\r\n              </button>\r\n            ) : (\r\n              <div className=\"custom-tag-form\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Tag name\"\r\n                  value={customTagName}\r\n                  onChange={(e) => setCustomTagName(e.target.value)}\r\n                  className=\"custom-tag-input\"\r\n                />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Your name (owner)\"\r\n                  value={customTagOwner}\r\n                  onChange={(e) => setCustomTagOwner(e.target.value)}\r\n                  className=\"custom-tag-input\"\r\n                />\r\n                <textarea\r\n                  placeholder=\"Short description (optional)\"\r\n                  value={customTagDescription}\r\n                  onChange={(e) => setCustomTagDescription(e.target.value)}\r\n                  className=\"custom-tag-textarea\"\r\n                  rows={2}\r\n                />\r\n                <div className=\"custom-tag-actions\">\r\n                  <button\r\n                    className=\"custom-tag-cancel\"\r\n                    onClick={() => {\r\n                      setShowCustomForm(false);\r\n                      setCustomTagName('');\r\n                      setCustomTagOwner('');\r\n                      setCustomTagDescription('');\r\n                    }}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    className=\"custom-tag-create\"\r\n                    onClick={handleAddCustomTag}\r\n                    disabled={!customTagName.trim() || !customTagOwner.trim()}\r\n                  >\r\n                    Create & Drag\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {draggedTag && draggedTag.isCustom && (\r\n            <div className=\"drag-instruction\">\r\n              <p>Now drag your custom tag \"{draggedTag.name}\" onto the chart</p>\r\n              <div\r\n                className=\"draggable-tag custom\"\r\n                draggable\r\n                onDragStart={(e) => handleDragStart(e, draggedTag)}\r\n                onDragEnd={handleDragEnd}\r\n              >\r\n                <span className=\"tag-marker\" style={{ background: draggedTag.color }}></span>\r\n                {draggedTag.name}\r\n                <span className=\"tag-owner\">by {draggedTag.owner}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default KPIChart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}